import{u as a,c as e,o as t,a as o,b as n,w as s,v as r,d as i,t as l,F as c,r as d,e as u,f as p,g as m,n as g,h,i as b,j as w}from"./vendor.779f32d0.js";const v={ru:{common:"обычный",hard:"сложный",madness:"безумный",goal:"Текущая цель",Status:"Положение дел",Gold:"Золото",Payday:"Дней до выплаты",Moral:"Мораль",Renown:"Известность"},en:{common:"common",hard:"hard",madness:"madness",goal:"Current target",Status:"Status",Gold:"Gold",Payday:"Days to payday",Moral:"Moral",Renown:"Renown"}};const k=["max"];const f={},_=Object.assign(f,{setup:function(d){const u=a(),p=e((()=>u.state.Entity));return(a,e)=>(t(),o(c,null,[n("div",null,[s(n("input",{type:"range",class:"hire",min:"0",max:i(p).Kojania.availableWarriors,"onUpdate:modelValue":e[0]||(e[0]=a=>i(p).tohire=a)},null,8,k),[[r,i(p).tohire,void 0,{number:!0}]]),n("button",{onClick:e[1]||(e[1]=a=>i(p).tohire=i(p).Kojania.availableWarriors),id:"allBtn"},"max")]),n("p",null,"К найму: "+l(i(p).tohire)+" || На сумму: "+l(i(p).tohire*i(p).Kojania.hirecost),1),n("button",{onClick:e[2]||(e[2]=a=>i(u).dispatch("hire",i(p).tohire)),id:"hireBtn"},"Нанять")],64))}});const y={key:0,class:"modal-mask"},C={class:"modal-wrapper"},M={class:"modal-position"},x={id:"contracts-block"},j={id:"contractTable"},K=n("tr",null,[n("th",null,"Тип"),n("th",null,"Мин. мощь"),n("th",null,"Реком. мощь"),n("th")],-1),q={key:0},P=["onClick"],R={class:"modal-mask"},D={class:"modal-wrapper"},T={class:"modal-position"},L={id:"error-block"},N=n("br",null,null,-1),I={class:"modal-mask"},G={class:"modal-wrapper"},Q={class:"modal-position"},W={id:"mission-block"},S={id:"plus"},O=n("hr",null,null,-1),A={class:"missionText"},E=n("br",null,null,-1);const B={},U=Object.assign(B,{setup:function(r){const g=a(),h=e((()=>g.state.Entity));return(a,e)=>(t(),o(c,null,[i(h).modalContracts?(t(),o("div",y,[n("div",C,[n("div",M,[n("div",x,[n("table",j,[K,(t(!0),o(c,null,d(i(h).contract_list,((a,e)=>(t(),o("tbody",null,[i(h).contracts[a.dif].isAvailable?(t(),o("tr",q,[n("td",null,l(i(h).Dict[a.dif]),1),n("td",null,l(a.minPower),1),n("td",null,l(a.recommendedPower),1),n("td",null,[n("button",{class:"closeCartButton",onClick:t=>i(g).dispatch("takeContract",{contract:a,index:e})},"Принять",8,P)])])):u("",!0)])))),256))]),n("button",{class:"closeCartButton",onClick:e[0]||(e[0]=a=>i(h).modalContracts--)},"Пожалуй не сейчас...")])])])])):u("",!0),s(n("div",R,[n("div",D,[n("div",T,[n("div",L,[m(l(i(h).modalErrorText)+" ",1),N,n("button",{class:"closeCartButton",onClick:e[1]||(e[1]=a=>i(h).modalError--)},"Понимаю")])])])],512),[[p,i(h).modalError]]),s(n("div",I,[n("div",G,[n("div",Q,[n("div",W,[(t(!0),o(c,null,d(i(h).niceQuestMsgs,((a,e)=>(t(),o("p",S,l(a),1)))),256)),O,n("p",A,l(i(h).modalMissionText),1),E,n("button",{class:"closeCartButton",onClick:e[2]||(e[2]=a=>i(h).modalMission--)},"Понимаю")])])])],512),[[p,i(h).modalMission]])],64))}});const H={class:"tab"},z={class:"row"},F=n("hr",{id:"niceLine"},null,-1),V={class:"rangSpecifics"},$={class:"rangText",id:"plus"},J={class:"rangText",id:"minus"},X=n("br",null,null,-1),Y=["src"],Z=n("hr",{id:"niceLine2"},null,-1),aa={class:"rangText",id:"rangText"};const ea={data:()=>({rangInfo:{smerd:{info:"Иногда попадаются толковые ребята. Но в среднем -- пушечное мясо, готовое обмочить штанишки при виде чуть грозного противника.",plus:["Дешевый","Легко обучается"],minus:["Массово гибнет"],url:"1"},dubolom:{info:"Дуболом отличился высоким боевым духом. Мастерство и экипировка все еще могут оставлять желать лучшего, но, по крайней мере, он не подводет в сложный и отвественный момент.",plus:["Неприхотлив","Обучение без рисков"],minus:["Слегка высокая смертность"],url:"2"},warrior:{info:"Воин звучит гордо. Хорошие навыки, разнообразное и качественное снаряжение, а так же непоколебимость -- это звание получают не просто так.",plus:["Сильный боец","Низкая смертность"],minus:["Обучение в бою"],url:"3"},veteran:{info:"Ветераны нашли способ пройти путь воина и сохранить большую из своих частей тела. Приобрели внушительную гибкость в снаряжении и умение выпутываться из сложной ситуации. Великолепные боевые навыки. Готовность успешно выполнить любой, самый безумный приказ. Хотя и это не предел.",plus:["Сильный боец","Очень низкая смертность"],minus:["Высокое содержание","Обучение в бою"],url:"4"},knight:{info:"Человеческая элита, лучшие из лучших. Без отваги на поле боя, граничащей с безумием, до этого ранга не дойти. Самые лучшие трофеи, в первую очередь, попадут в их загребущие до интересностей рученки. Качество их снаряжения, как и расходы в золоте, взлетают до запредельного уровня.",plus:["Очень сильный боец","Крайне живучий гад"],minus:["Очень высокое содержание","Обучается в сложных битвах"],url:"5"},hero:{info:"Специализация героев может быть самой разной. Умения на грани здравого смысла. Сотни и тысячи поверженных врагов на личном счету. Различные могущественные артефакты -- все это обязательные атрибуты Героев.",plus:["Сила не поддается описанию","Условно бессмертен"],minus:["Безумно сложное обучение"],url:"6"}},rangName:{smerd:"Рекрут",dubolom:"Дуболом",warrior:"Воин",veteran:"Ветеран",knight:"Рыцарь",hero:"Герой"}}),props:["name","url"],methods:{}},ta=Object.assign(ea,{setup:function(s){function r(a){return new URL({"./rang-avarars/1.png":"/Kojania/assets/1.ea454ab5.png","./rang-avarars/2.png":"/Kojania/assets/2.c8991c68.png","./rang-avarars/3.png":"/Kojania/assets/3.72bd031c.png","./rang-avarars/4.png":"/Kojania/assets/4.7cf7f6ff.png","./rang-avarars/5.png":"/Kojania/assets/5.30a644bf.png","./rang-avarars/6.png":"/Kojania/assets/6.bd119c05.png"}[`./rang-avarars/${a}.png`],window.location).href}console.log("/Kojania/rang-avarars/1.png"),console.log(r(1));const u=a(),p=e((()=>u.state.Entity));return(a,e)=>(t(),o("div",H,[n("div",z,[n("div",null,[n("h2",null,l(i(p).rangName[s.name]),1),F,n("div",V,[(t(!0),o(c,null,d(a.rangInfo[s.name].plus,(a=>(t(),o("p",$,"+ "+l(a),1)))),256)),(t(!0),o(c,null,d(a.rangInfo[s.name].minus,(a=>(t(),o("p",J,"- "+l(a),1)))),256)),X,n("p",null,"Cодержание: "+l(i(p).wpc[s.name]),1)])]),n("div",null,[n("div",null,[n("img",{id:"pic",src:r(a.rangInfo[s.name].url),alt:"",srcset:""},null,8,Y)])])]),Z,n("p",aa,l(a.rangInfo[s.name].info),1),n("button",{class:"closeCartButton",onClick:e[0]||(e[0]=a=>i(p).show.rangInfo=!1)},"Закрыть")]))}});const oa={class:"modal-position",style:{"margin-left":"-185px"}},na={id:"tab-buttons-cont"},sa=["onClick","disabled"],ra={key:0},ia={key:1};const la={components:{RangCart:ta},data:()=>({currentTab:"smerd",tabs:["smerd","dubolom","warrior","veteran","knight","hero"]})},ca=Object.assign(la,{setup:function(s){const r=a(),u=e((()=>r.state.Entity));return(a,e)=>(t(),o("div",oa,[n("div",na,[(t(!0),o(c,null,d(a.tabs,((e,n)=>(t(),o("button",{key:e,class:g(["tab-button",{active:a.currentTab===e}]),onClick:t=>a.currentTab=e,disabled:!(i(u).wa[e]>0)},[i(u).wa[e]>0?(t(),o("span",ra,l(i(u).rangName[e])+l(),1)):(t(),o("span",ia,"???"))],10,sa)))),128))]),h(ta,{name:a.currentTab},null,8,["name"])]))}});const da={id:"content"},ua={id:"localContainerPositioner"},pa={id:"local"},ma={id:"goalContainerPositioner"},ga={id:"goalContainer"},ha={align:"left"},ba={id:"globalInfoRow"},wa=n("hr",{class:"svl"},null,-1),va=n("hr",{class:"svl"},null,-1),ka=n("hr",null,null,-1),fa={id:"globalInfoRow"},_a=n("hr",{class:"svl"},null,-1),ya=n("hr",{class:"svl"},null,-1),Ca={id:"contentPositioner"},Ma={class:"kojaniaCont"},xa=n("h3",null,"Кожания",-1),ja=m("Отношения: "),Ka=m("Уровень процветания: "),qa=m(" Демоническая угроза: "),Pa=m("Цена рекрута: "),Ra=n("br",null,null,-1),Da={class:"squadCont"},Ta=n("h3",null,"Состав отряда",-1),La={key:0},Na=["onClick","toolTip"],Ia=["onClick","toolTip"],Ga=["onClick","toolTip"],Qa=["onClick","toolTip"],Wa=n("br",null,null,-1),Sa={class:"modal-mask"},Oa={class:"modal-wrapper"},Aa={id:"day"},Ea=n("br",null,null,-1),Ba=n("hr",null,null,-1),Ua={style:{"min-width":"400px"}},Ha=n("h3",null,"События",-1),za={class:"ml"},Fa={class:"ml"},Va=n("hr",null,null,-1),$a=n("br",null,null,-1);const Ja={data:()=>({local:"ru"}),methods:{l10n(a){return"en"==this.local&&void 0===v[this.local][a]?a:v[this.local][a]}}},Xa=Object.assign(Ja,{setup:function(r){const b=a(),w=e((()=>b.state.Entity));return b.commit("setDict","en"),(a,e)=>(t(),o("div",da,[n("div",ua,[n("div",pa,[i(w).isDebug?(t(),o("button",{key:0,onClick:e[0]||(e[0]=a=>i(b).commit("setDict","en")),class:"btnex"},"en")):u("",!0),i(w).isDebug?(t(),o("button",{key:1,onClick:e[1]||(e[1]=a=>i(b).commit("setDict","ru")),class:"btnex"},"ru")):u("",!0)])]),n("div",ma,[n("div",ga,[n("h3",null,l(i(w).Dict.goal),1),n("p",null,l(i(w).quests[i(w).quests.active].goal),1)])]),n("div",null,[n("h3",ha,l(i(w).Dict.Status),1)]),n("div",ba,[n("p",null,l(i(w).Dict.Gold)+": "+l(i(w).gold),1),wa,n("p",null,l(i(w).Dict.Moral)+": "+l(i(w).squadState.morality),1),n("button",{class:"moralButton",onClick:e[2]||(e[2]=()=>{})},"▼"),va,n("p",null,l(i(w).Dict.Renown)+": "+l(Math.floor(i(w).squadState.reputation)),1)]),ka,n("div",fa,[n("p",null,l(i(w).Dict.Payday)+": "+l(i(w).squadState.paydayleft),1),_a,n("p",null,"Жалование: "+l(i(b).getters.payday),1),ya,n("button",{onClick:e[3]||(e[3]=()=>{})},"Финансы")]),n("div",Ca,[n("div",Ma,[xa,n("p",null,[ja,n("span",{class:g(i(b).getters.kojaniaReputation[1])},l(i(b).getters.kojaniaReputation[0]),3)]),n("p",null,[Ka,n("span",{class:g(i(b).getters.kojaniaProsperity[1])},l(i(b).getters.kojaniaProsperity[0]),3)]),n("p",null,[qa,n("span",{class:g(i(b).getters.demonicPresence[1])},l(i(b).getters.demonicPresence[0]),3)]),n("p",null,[Pa,n("span",null,l(i(w).Kojania.hirecost),1)]),n("p",null,"Свободные рекруты: "+l(i(w).Kojania.availableWarriors),1),h(_),Ra,s(n("div",null,[n("p",null,"Контракты: "+l(i(w).availableContracts),1),s(n("button",{onClick:e[4]||(e[4]=a=>i(b).commit("openContractList"))},"Прием контрактов",512),[[p,i(w).availableContracts>0]])],512),[[p,i(w).isAvailableContracts&&!i(w).contract_is_taken[3]]]),s(n("p",null,"Принят контракт",512),[[p,i(w).contract_is_taken[0]]]),s(n("p",null,"Принят сложный контракт",512),[[p,i(w).contract_is_taken[1]]]),s(n("p",null,"Принят безумный контракт",512),[[p,i(w).contract_is_taken[2]]])]),n("div",Da,[Ta,(t(!0),o(c,null,d(i(w).squad,((a,e)=>(t(),o("p",{class:"squadList",key:a},[a>0?(t(),o("div",La,[m(l(i(w).rangName[e])+": "+l(a)+" ",1),i(w).squad_imp[e]>0&&i(w).wa[e]>1?(t(),o("button",{key:0,onClick:a=>i(b).dispatch("rangUp",{rang:e,count:1}),toolTip:"Стоимость: "+2*i(w).wpc[e],class:"tooltip"}," 1+ ",8,Na)):u("",!0),i(w).squad_imp[e]>=10&&i(w).wa[e]>1?(t(),o("button",{key:1,onClick:a=>i(b).dispatch("rangUp",{rang:e,count:10}),toolTip:"Стоимость: "+2*i(w).wpc[e]*10,class:"tooltip"}," 10+ ",8,Ia)):u("",!0),i(w).squad_imp[e]>=100&&i(w).wa[e]>1?(t(),o("button",{key:2,onClick:a=>i(b).dispatch("rangUp",{rang:e,count:100}),toolTip:"Стоимость: "+2*i(w).wpc[e]*100,class:"tooltip"}," 100+ ",8,Ga)):u("",!0),i(w).squad_imp[e]>1&&i(w).wa[e]>1?(t(),o("button",{key:3,onClick:a=>i(b).dispatch("rangUp",{rang:e,count:i(w).squad_imp[e]}),toolTip:"Стоимость: "+i(w).squad_imp[e]*i(w).wpc[e]*2,class:"tooltip"},l(i(w).squad_imp[e])+"+ ",9,Qa)):u("",!0)])):u("",!0)])))),128)),Wa,n("p",null,"Всего людей: "+l(i(b).getters.totalPeople),1),n("p",null,"Боевая мощь: "+l(i(b).getters.power),1),i(w).wa.smerd>0?(t(),o("button",{key:0,onClick:e[5]||(e[5]=a=>i(b).commit("openRangInfo"))},"? о рангах")):u("",!0)])]),s(n("div",Sa,[n("div",Oa,[h(ca)])],512),[[p,i(w).show.rangInfo]]),n("div",null,[n("span",Aa,"День: "+l(i(w).day),1),Ea,n("button",{onClick:e[6]||(e[6]=a=>i(b).dispatch("toNextDay")),class:"btnex"},"Завершение дня.")]),n("p",null,"Прогноз рекрутов на завтра: "+l(i(b).getters.targetAvailableWarriors),1),Ba,n("div",Ua,[Ha,n("p",za,l(i(w).messageLog1),1),(t(!0),o(c,null,d(i(w).messageLog2,((a,e)=>(t(),o("p",Fa,l(i(w).messageLog2[e]),1)))),256))]),Va,i(w).isDebug?(t(),o("button",{key:0,onClick:e[7]||(e[7]=a=>i(b).commit("addRep")),class:"btnex"},"+50 rep")):u("",!0),i(w).isDebug?(t(),o("button",{key:1,onClick:e[8]||(e[8]=a=>i(b).commit("addx2Rep")),class:"btnex"},"x2 rep")):u("",!0),i(w).isDebug?(t(),o("button",{key:2,onClick:e[9]||(e[9]=a=>i(b).commit("addRen")),class:"btnex"},"+50 ren")):u("",!0),i(w).isDebug?(t(),o("button",{key:3,onClick:e[10]||(e[10]=a=>i(b).commit("addGold")),class:"btnex"},"x10 gold")):u("",!0),i(w).isDebug?(t(),o("button",{key:4,onClick:e[11]||(e[11]=a=>i(b).commit("addDaemons")),class:"btnex"},"x2 daemons")):u("",!0),$a,i(w).isDebug?(t(),o("button",{key:5,onClick:e[12]||(e[12]=a=>i(b).dispatch("showWhatHiden")),class:"btnex"},"showWhatHiden()")):u("",!0),h(U)]))}});const Ya=b({modules:{Entity:{state:()=>({local:"ru",day:1,gold:1120,show:{rangInfo:!1},squadState:{paydayleft:6,morality:50,reputation:0},squad:{smerd:6,dubolom:0,warrior:0,veteran:0,knight:0,hero:0},tohire:0,wa:{smerd:0,dubolom:0,warrior:0,veteran:0,knight:0,hero:0},wpc:{smerd:7,dubolom:12,warrior:35,veteran:100,knight:300,hero:1e3},wp:{smerd:10,dubolom:16,warrior:32,veteran:50,knight:100,hero:700},wdc:{smerd:40,dubolom:16,warrior:7,veteran:3,knight:2,hero:.01},warriorsdie:{smerd:0,dubolom:0,warrior:0,veteran:0,knight:0,hero:0},exp:{smerd:[60,0],dubolom:[200,0],warrior:[400,0],veteran:[1e3,0],knight:[4e3,0],hero:[1e6,0]},expbaseinc:{smerd:[2,3,4,5],dubolom:[2,4,8,12],warrior:[2,6,12,24],veteran:[2,6,12,36],knight:[2,6,12,48],hero:[0,0,0,0]},expreward:0,squad_imp:{smerd:0,dubolom:0,warrior:0,veteran:0,knight:0,hero:0},Kojania:{demonicPresence:30,demonicPresenceList:[{num:200,className:"white-grade",text:"редкие одиночные цели"},{num:1e3,className:"green-grade",text:"редкие малые стаи"},{num:2500,className:"yellow-grade",text:"возможны крупные стаи"},{num:5e3,className:"red-grade",text:"орды демонов"},{num:9e3,className:"black-grade",text:"чудовищные орды демонов"}],prosperity:250,prosperityList:[{num:50,className:"black-grade",text:"пепелище"},{num:200,className:"red-grade",text:"восстановление"},{num:1e3,className:"yellow-grade",text:"укрепление"},{num:2500,className:"green-grade",text:"стабильность"},{num:5e3,className:"white-grade",text:"экспансия"}],reputation:0,repSumm:0,reputationGain:[],reputationList:[{num:108,className:"yellow-grade",text:"нейтральные"},{num:250,className:"green-grade",text:"открытые"},{num:1e3,className:"white-grade",text:"теплые"},{num:5e3,className:"white-grade",text:"дружеские"},{num:1e4,className:"white-grade",text:"союзные"}],goldBonus:1,enemyBonus:1,availableWarriors:1,targetAvailableWarriors:2,baseHireCost:140,hirecost:14},messageLog1:"",messageLog2:[],battleReport:{result:{key:0,text:[]},gold:0,exp:0},Dict:{},info:["Демоны -- крайне опасные существа. Даже слабейший из них, за счет невероятной грубой силы и живучести, требует слаженной работы десятка людей. У них множество подвидов с различными особенностями. Но, как правило, дальнобойное оружие и добротные копья делают свое дело. По возможности лучше использовать ловушки и не допускать сближения.","Тушки демонов пользуются хорошим спросом. Почти каждую часть их тела можно считать стратегическим ресурсом. Кроме съедобного мяса это отличные доспехи из кожи. Вполне боеспособные луки и арбалеты из прочных связок. Невероятно огромный список амуниции из костей. Каждый участник охоты или сражения получает часть прибыли с этих трофеев."],quests:{active:"hire_10_smerd",hire_10_smerd:{goal:"Нанять 10 рекрутов",finishText:"Рекруты набираются опыта в бою и на тренировке. Когда они будут готовы стоит подумать об их продвижении. При продвижении придется заплатить разовое 2х недельное жалование. Но зато бойцы обязуются улучшить снаряжение, что сделает их сильнее уже в следующем бою и мотивирует на новые подвиги.",niceQuestMsgs:["Можно продвигать рекрутов.","Доступны простые контракты."]},found_contract:{goal:"Выполнить контракт.",finishText:"Время от времени будут появляться различные контракты. Их выполнение важно как для Кожании так и для нас. Хотя мы и не обызаны под этим подписываться, без Кожании у нас мало шансов. Заказчик укажет минимальные требования и предпологаемые проблемы... Однако реальность всегда может оказаться намного хуже самых смелых ожиданий. Если мы не хотим потерять все, нам придется быть к этому, по возможности, готовыми.",niceQuestMsgs:["Можно продвигать дуболомов.","Доступны сложные контракты."]},take_3000_gold:{goal:"3000 золота и 500 мощи",finishText:"Местный староста -- солидный господин. Он весьма снисходителен к гостям и готов бесплатно предоставлять некоторый уровень безопасности. Правда, вне центральной крепости, которая с каждым днем становится все более массивной. Благодаря его политике золото в цене даже в такие времена, а мы без проблем можем купить хорошую экипировку для наших воинов.",niceQuestMsgs:["Отдана 1000 золота, отношения улучшились.","Доступен прогноз рекрутов на следующий день.","Доступно резервирование отрядов."]},take_20_warriors:{goal:"20 воинов и 2000 мощи",finishText:"Нужно полностью захватить и обустроить рудные шахты и помочь с остальными ресурсами, расположенными далеко от поселения. Некоторые контракты -- чистое самоубийство, но вместе с тем их стратегическое значение крайне велико, возможно деже жизненно необходимо.",niceQuestMsgs:["Можно продвигать воинов","Доступны безумные контракты."]},take_10_veterans:{goal:"10 ветеранов и 5000 мощи",finishText:"Наша известность работает в обе стороны. В прославленный отряд присоединяется больше людей и этими людьми проще управлять. Нам доверяют самое лучшие оружие и щедро платят за трофеи. Однако лишь совсем ленивый или в конец тупой не заметил бы наши слабые места. Чем дольше мы сидим на одном месте, тем больше внимания в округе мы привлекаем. За стенами это не так заметно. Но к каждому контракту нужно относиться с осторожностью.",niceQuestMsg1:"Можно продвигать ветеранов",niceQuestMsgs:["Можно продвигать ветеранов."]},take_10_knights:{goal:"10 рыцарей и 9000 мощи",finishText:"Туши убитых демонов полны сюрпризов. Металлурги и алхимики делают исключительные открытия и создают невероятные вещи. Конечно, кто-то должен эти туши добыть, как правило ценой своих жизней, а потом кто-то должен с ними как следует поработать. Но в такие времена сам факт прогресса уже вселяет надежду.",niceQuestMsgs:["Можно продвигать рыцарей."]},take_10_heroes:{goal:"10 героев и 40к мощи",finishText:"Победа (нет)",niceQuestMsgs:[""]}},isAvailableContracts:!1,contracts:{common:{isAvailable:!1,generationChance:[12,12],revard:{first:200,loot:20},prosperityChange:6,reputationCnange:8,chancetoLose:[0,10],basePower:50,scaleRange:6},hard:{isAvailable:!1,generationChance:[5,5],revard:{first:600,loot:35},prosperityChange:10,reputationCnange:16,chancetoLose:[0,4],basePower:300,scaleRange:4},madness:{isAvailable:!1,generationChance:[2,2],revard:{first:1800,loot:50},prosperityChange:20,reputationCnange:32,chancetoLose:[0,2],basePower:1e3,scaleRange:3}},contract_list:[],availableContracts:0,contract_is_taken:[0,0,0,0],rangName:{smerd:"Рекрут",dubolom:"Дуболом",warrior:"Воин",veteran:"Ветеран",knight:"Рыцарь",hero:"Герой"},modalError:!1,modalMission:!1,modalContracts:!1,modalErrorText:"",modalMissionText:"",niceQuestMsgs:[],takenContract:{},isDebug:!0}),mutations:{setDict(a,e){a.Dict=v[e];for(const t in v.en)void 0===a.Dict[t]&&(a.Dict[t]=v.en[t])},toNextDay(a){a.day++,a.squadState.paydayleft--,a.Kojania.demonicPresence+=.01*a.Kojania.demonicPresence+1},time2Pay(a,e){a.squadState.paydayleft+=7,a.gold-=e},hire(a,e){a.squad.smerd+=e,a.gold-=a.Kojania.hirecost*e,a.Kojania.availableWarriors-=e},hire_reset_helper(a,e){a.Kojania.availableWarriors<e&&(a.tohire=a.Kojania.availableWarriors)},availableWarriors(a){a.Kojania.availableWarriors=Math.floor(a.Kojania.availableWarriors*Math.min(.6*(1+Math.pow(a.Kojania.prosperity,.5)/100),1)+Math.random()*Math.pow(a.Kojania.reputation+10,.7)),a.Kojania.availableWarriors<a.tohire&&(a.tohire=a.Kojania.availableWarriors)},rangUp(a,{rang:e,count:t}){switch(a.squad_imp[e]-=t,a.squad[e]-=t,a.gold-=t*a.wpc[e]*2,e){case"smerd":a.squad.dubolom+=t;break;case"dubolom":a.squad.warrior+=t;break;case"warrior":a.squad.veteran+=t;break;case"veteran":a.squad.knight+=t;break;case"knight":a.squad.hero+=t}},openContractList(a){a.modalContracts=!0},openRangInfo(a){a.show.rangInfo=!0},error(a,e){a.modalErrorText=e,a.modalError=!0},addGold(a){a.gold*=10},addRep(a){a.Kojania.reputation+=50,console.log(a.Kojania.reputation)},addRen(a){a.squadState.reputation+=50,console.log(a.squadState.reputation)},addx2Rep(a){a.Kojania.reputation*=2,console.log(a.Kojania.reputation)},addDaemons(a){a.Kojania.demonicPresence*=2,console.log(a.Kojania.demonicPresence)}},actions:{toNextDay({commit:a,state:e,getters:t,dispatch:o}){a("toNextDay"),0==e.squadState.paydayleft&&a("time2Pay",t.payday),a("availableWarriors"),o("checkQuest"),o("generateContracts"),o("battlesimulation"),o("contractManager")},checkQuest({commit:a,state:e,getters:t,dispatch:o},n){let s=e.quests,r=e.squad;switch(s.active){case"hire_10_smerd":r.smerd>=10&&(o("showQuestMsg",s),e.wa.smerd=2,e.wa.dubolom=1,e.isAvailableContracts=!0,e.contracts.common.isAvailable=!0,s.active="found_contract",o("generateContract",{str:"common",minPower:50,recPw:80,rlPw:90,e:0,f:0,g:5,h:5}).then((a=>{e.contract_list.push(a)})));break;case"found_contract":n&&(o("showQuestMsg",s),e.wa.dubolom=2,e.wa.warrior=1,e.contracts.hard.isAvailable=!0,s.active="take_3000_gold");break;case"take_3000_gold":e.gold>3e3&&this.power>500&&(e.gold-=1e3,e.Kojania.reputation+=50,o("showQuestMsg",s),s.active="take_20_warriors");break;case"take_20_warriors":r.warrior>=20&&this.power>2e3&&(o("showQuestMsg",s),e.wa.warrior=2,e.wa.veteran=1,e.contracts.madness.isAvailable=!0,s.active="take_10_veterans");break;case"take_10_veterans":r.veteran>=10&&this.power>5e3&&(o("showQuestMsg",s),e.wa.veteran=2,e.wa.knight=1,s.active="take_10_knights");break;case"take_10_knights":r.knight>=10&&this.power>9e3&&(o("showQuestMsg",s),e.wa.knight=2,e.wa.hero=1,s.active="take_10_heroes");break;case"take_10_heroes":r.hero>=10&&this.power>2e4&&o("showQuestMsg",s)}},generateContracts({commit:a,state:e,getters:t,dispatch:o}){let n=e.contracts,s=e.contract_list,r=n.common.generationChance,i=n.common.chancetoLose,l=n.hard.generationChance,c=n.hard.chancetoLose,d=n.madness.generationChance,u=n.madness.chancetoLose;const p=e.Kojania.enemyBonus;if(r[1]/100>Math.random()){let a=Math.round((Math.random()*(n.common.scaleRange-1)+1)*n.common.basePower);const t=Math.round(a*(Math.random()/1.5+1));o("generateContract",{str:"common",minPower:a,recPw:t,rlPw:Math.round(.9*t*(1+Math.sqrt(e.Kojania.demonicPresence)/75)*p),e:i[0],f:i[1],g:n.common.prosperityChange,h:n.common.reputationCnange}).then((a=>{s.push(a)})),r[1]-=100}else r[1]=r[1]+r[0];if(l[1]/100>Math.random()){let a=Math.round((Math.random()*(n.hard.scaleRange-1)+1)*n.hard.basePower);const t=Math.round(a*(Math.random()/1.5+1));o("generateContract",{str:"hard",minPower:a,recPw:t,rlPw:Math.round(.9*t*(1+Math.sqrt(e.Kojania.demonicPresence)/50)*p),e:c[0],f:c[1],g:n.hard.prosperityChange,h:n.hard.reputationCnange}).then((a=>{s.push(a)})),l[1]-=100}else l[1]=l[1]+l[0];if(d[1]/100>Math.random()){let a=Math.round((Math.random()*(n.madness.scaleRange-1)+1)*n.madness.basePower);const t=Math.round(a*(Math.random()/1.5+1));o("generateContract",{str:"madness",minPower:a,recPw:t,rlPw:Math.round(.9*t*(1+Math.sqrt(e.Kojania.demonicPresence)/25)*p),e:u[0],f:u[1],g:n.madness.prosperityChange,h:n.madness.reputationCnange}).then((a=>{s.push(a)})),d[1]-=100}else d[1]=d[1]+d[0]},generateContract:(a,{str:e,minPower:t,recPw:o,rlPw:n,e:s,f:r,g:i,h:l})=>({dif:e,minPower:t,recommendedPower:o,realPower:n,chancetoLose:s,changeChance:r,prosperity:i,reputation:l}),contractManager({state:a,dispatch:e}){let t=a.contract_list;a.availableContracts=0;for(const o in t)a.contracts[t[o].dif].isAvailable&&a.availableContracts++,Math.random()<t[o].chancetoLose/100?(a.isDebug&&e("log2","Кожания теряет процветание, "+a.Dict[t[o].dif]+" контракт просрочен."),a.Kojania.prosperity-=t[o].prosperity/2,a.Kojania.prosperity<1&&(a.Kojania.prosperity=1),a.contracts[t[o].dif].isAvailable&&a.availableContracts--,t.splice(o,1)):t[o].chancetoLose+=t[o].changeChance},takeContract({state:a},{contract:e,index:t}){switch(a.takenContract=e,e.dif){case"common":a.contract_is_taken[0]=1,a.contract_is_taken[3]=1;break;case"hard":a.contract_is_taken[1]=1,a.contract_is_taken[3]=1;break;case"madness":a.contract_is_taken[2]=1,a.contract_is_taken[3]=1}a.contract_list.splice(t,1),a.modalContracts--},async battlesimulation({state:a,dispatch:e,getters:t}){if(a.contract_is_taken[3])if(a.takenContract.minPower<t.power){const o=a.takenContract.realPower,n=await e("combatScenario",{enemy:o,ally:t.power});if(a.contract_is_taken[0])if("retreat"==n[0]){e("battleResoult",{msg:"Пришлось отступать. Многие бойцы отдали жизни ради сохранения отряда. Это тяжелый удар.",dif:n[1],ep:o,ep_mlp:3,gold:0,goldMlp:0,reputation:0}),e("expGained",3),e("contractIsOver","fail")}else if("very hard"==n[0]){e("battleResoult",{msg:"Враг был намного сильнее. Но именно в таких битвах куется слава и репутация.",dif:n[1],ep:o,ep_mlp:1.5,gold:200,goldMlp:.7,reputation:12}),e("expGained",3),e("contractIsOver","win")}else if("hard"==n[0]){e("battleResoult",{msg:"Почти равный бой. Приобретен ценный опыт.",dif:n[1],ep:o,ep_mlp:1,gold:200,goldMlp:.7,reputation:5}),e("expGained",2),e("contractIsOver","win")}else e("battleResoult",{msg:"Враг оказался намного слабее нас.",dif:n[1],ep:o,ep_mlp:.4,gold:200,goldMlp:.7,reputation:3}),e("expGained",1),e("contractIsOver","win");else if(a.contract_is_taken[1])if("retreat"==n[0]){e("battleResoult",{msg:"Пришлось отступать. Многие бойцы отдали жизни ради сохранения отряда. Это тяжелый удар.",dif:n[1],ep:o,ep_mlp:3,gold:0,goldMlp:0,reputation:0}),e("expGained",3),e("contractIsOver","fail")}else if("very hard"==n[0]){e("battleResoult",{msg:"Враг был намного сильнее. Но именно в таких битвах куется слава и репутация.",dif:n[1],ep:o,ep_mlp:1.5,gold:600,goldMlp:.9,reputation:18}),e("expGained",3),e("contractIsOver","win")}else if("hard"==n[0]){e("battleResoult",{msg:"Почти равный бой. Приобретен ценный опыт. ",dif:n[1],ep:o,ep_mlp:1,gold:600,goldMlp:.9,reputation:10}),e("expGained",2),e("contractIsOver","win")}else e("battleResoult",{msg:"Враг оказался намного слабее нас.",dif:n[1],ep:o,ep_mlp:.4,gold:600,goldMlp:.9,reputation:8}),e("expGained",1),e("contractIsOver","win");else if("retreat"==n[0]){e("battleResoult",{msg:"Пришлось отступать. Многие бойцы отдали жизни ради сохранения отряда. Это тяжелый удар.",dif:n[1],ep:o,ep_mlp:3,gold:0,goldMlp:0,reputation:0}),e("expGained",3),e("contractIsOver","fail")}else if("very hard"==n[0]){e("battleResoult",{msg:"Враг был намного сильнее. Но именно в таких битвах куется слава и репутация.",dif:n[1],ep:o,ep_mlp:1.5,gold:1800,goldMlp:1,reputation:30}),e("expGained",3),e("contractIsOver","win")}else if("hard"==n[0]){e("battleResoult",{msg:"Почти равный бой. Приобретен ценный опыт. ",dif:n[1],ep:o,ep_mlp:1,gold:1800,goldMlp:1,reputation:20}),e("expGained",2),e("contractIsOver","win")}else e("battleResoult",{msg:"Враг оказался намного слабее нас.",dif:n[1],ep:o,ep_mlp:.4,gold:1800,goldMlp:1,reputation:18}),e("expGained",1),e("contractIsOver","win")}else e("log1","У нас не хватит сил на выполнение контракта."),e("contractIsOver","fail");else{let s=a.Kojania.demonicPresence/a.Kojania.prosperity,r=Math.sqrt(a.Kojania.demonicPresence+100)*s,i=10*r*(1+Math.sqrt(a.squadState.reputation)/10*(1+Math.sqrt(a.Kojania.demonicPresence)/100)),l=(o=r,n=i,Math.random()*(n-o)+o);if(s<1){const a=1-s;if(l<t.power/10){const e=t.power/10;l=Math.min((1+a)*l,e)}}if(t.power>0){let a=await e("combatScenario",{enemy:l,ally:t.power});if("retreat"==a[0]){e("battleResoult",{msg:"Охота обернулась адом для жителей, хотя мы и попытались немного снизить потери.",dif:a[1],ep:l,ep_mlp:2,gold:0,goldMlp:0,reputation:0})}else if("very hard"==a[0]){e("battleResoult",{msg:"Охота превратилась в кровавую битву. Жители благодарны за подаренный им день и готовы щедро заплатить за трофеи.",dif:a[1],ep:l,ep_mlp:1.25,gold:0,goldMlp:1,reputation:8}),e("expGained",3)}else"hard"==a[0]?(e("battleResoult",{msg:"Хоть и было сложно, славная выдалась охота.",dif:a[1],ep:l,ep_mlp:1,gold:0,goldMlp:.7,reputation:3}),e("expGained",2)):"nice battle"==a[0]?(e("battleResoult",{msg:"На патруле возникли сложности.",dif:a[1],ep:l,ep_mlp:.6,gold:0,goldMlp:.65,reputation:1}),e("expGained",1)):(e("battleResoult",{msg:"Охота и тренировки прошли гладко.",dif:a[1],ep:l,ep_mlp:.5,gold:0,goldMlp:.6,reputation:.25}),e("expGained",0))}}var o,n},battleResoult({state:a,dispatch:e},{msg:t,dif:o,ep:n,ep_mlp:s,gold:r,goldMlp:i,reputation:l}){e("log1",t);const c=Math.round((r+n*i)*a.Kojania.goldBonus);c>0&&(e("log2","Получено золота: "+c),a.gold+=c),a.squadState.reputation+=l,e("squadLoses",{dif:o,ep_mlp:s})},squadLoses({state:a,dispatch:e},{dif:t,ep_mlp:o}){const n=Object.entries(a.squad);let s=!1;if(n.forEach(((e,n,r)=>{console.log(t);const i=Math.floor(Math.min(r[n][1]*a.wdc[r[n][0]]/100*t*o,r[n][1]));i>0&&(s=!0,a.warriorsdie[r[n][0]]=i),a.squad[r[n][0]]-=i})),s){for(var r in e("log2","-----"),e("log2","Потери"),a.warriorsdie)a.squad[r]>0&&(a.squad_imp[r]-=Math.floor(a.warriorsdie[r]*(a.squad_imp[r]/a.squad[r]))),a.warriorsdie[r]>0&&e("log2",a.rangName[r]+": "+a.warriorsdie[r]);e("log2","-----")}},combatScenario({},{enemy:a,ally:e}){let t=a/e,o=["",t];return o[0]=t>=2?"retreat":t>=1?"very hard":t>=.5?"hard":t>.1?"nice battle":"ez battle",o},expGained({state:a,dispatch:e},t){let o=0,n=0,s=a.exp;for(const r in a.exp)for(o=a.expbaseinc[r][t]*(a.squad[r]-a.squad_imp[r]),n+=o,s[r][1]+=o;s[r][1]>s[r][0];)a.squad_imp[r]++,s[r][1]-=s[r][0],a.isDebug&&console.log(r+" improve");n>0&&e("log2","Общий заработанный опыт: "+n)},rangUp({state:a,commit:e},{rang:t,count:o}){a.gold>o*a.wpc[t]*2?e("rangUp",{rang:t,count:o}):e("error","Нужно больше золота.")},contractIsOver({state:a,dispatch:e},t){a.contract_is_taken.forEach(((a,e,t)=>{t[e]=0})),"win"==t?(a.Kojania.prosperity*=1+a.takenContract.prosperity/100,a.Kojania.reputation+=a.takenContract.reputation,e("log2","Контракт выполнен."),"common"==a.takenContract.dif&&e("checkQuest","found_contract")):"fail"==t?(a.Kojania.prosperity*=1-1.5*a.takenContract.prosperity/100,a.Kojania.reputation-=2*a.takenContract.reputation,e("log2","Контракт провален.")):a.Kojania.prosperity*=1-a.takenContract.prosperity/2/100},log1({state:a},e){a.messageLog1=e},log2({state:a},e){a.messageLog2.push(e)},showWhatHiden({state:a}){console.log(a.contract_list)},showQuestMsg({dispatch:a},e){a("finishMissionMessage",{text:e[e.active].finishText,msg:e[e.active].niceQuestMsgs})},finishMissionMessage({state:a},{text:e,msg:t}){a.modalMissionText=e,a.modalMission=!0,a.niceQuestMsgs=t},hire({commit:a,state:e},t){a("hire_reset_helper",1),e.gold>=e.Kojania.hirecost*t&&e.Kojania.availableWarriors>0?a("hire",t):e.Kojania.availableWarriors>0?a("error","Нужно больше золота."):a("error","Рекруты закончились. Возможно завтра будут новые."),a("hire_reset_helper",1)}},getters:{payday:(a,e)=>{let t=0;for(let o in a.squad)t+=a.squad[o]*a.wpc[o];return t},power:(a,e)=>{let t=0;for(let o in a.squad)t+=a.squad[o]*a.wp[o];return t},totalPeople:(a,e)=>{let t=0;for(let o in a.squad)t+=a.squad[o];return t},demonicPresence:(a,e)=>{for(const t of a.Kojania.demonicPresenceList)if(Math.min(9e3,a.Kojania.demonicPresence)<=t.num)return[t.text,t.className]},kojaniaReputation:(a,e)=>{for(const t of a.Kojania.reputationList)if(Math.min(1e4,a.Kojania.repSumm)<=t.num)return[t.text,t.className]},kojaniaProsperity:(a,e)=>{for(const t of a.Kojania.prosperityList)if(Math.min(5e3,a.Kojania.prosperity)<=t.num)return[t.text,t.className]},targetAvailableWarriors:(a,e)=>Math.floor(a.Kojania.availableWarriors*Math.min(.6*(1+Math.pow(a.Kojania.prosperity,.5)/100),1)+Math.pow(a.Kojania.reputation+10,.7)/2)}}}});w(Xa).use(Ya).mount("#app");
