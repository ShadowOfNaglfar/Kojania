import{u as a,c as e,o as t,a as o,b as s,w as n,v as r,d as l,t as i,F as d,e as c,f as u,r as m,g as p,h,n as g,i as v,j as b,k as f}from"./vendor.71af84ca.js";const y={ru:{common:"обычный",hard:"сложный",madness:"безумный",goal:"Текущая цель",Status:"Положение дел",Gold:"Золото",Payday:"Дней до выплаты",Moral:"Мораль",Renown:"Известность",smerd:"Рекрут",dubolom:"Дуболом",warrior:"Воин",veteran:"Ветеран",knight:"Рыцарь",hero:"Герои",smerds:"Рекруты",duboloms:"Дуболомы",warriors:"Воины",veterans:"Ветераны",knights:"Рыцари",heroes:"Герои"},en:{common:"common",hard:"hard",madness:"madness",goal:"Current target",Status:"Status",Gold:"Gold",Payday:"Days to payday",Moral:"Moral",Renown:"Renown",smerd:"smerd",dubolom:"dubolom",warrior:"warrior",veteran:"veteran",knight:"knight",hero:"hero",smerds:"smerds",duboloms:"duboloms",warriors:"warriors",veterans:"veterans",knights:"knights",heroes:"heroes"}};const w=["max"];const k={},M=Object.assign(k,{setup:function(c){const u=a(),m=e((()=>u.state.Entity));return(a,e)=>(t(),o(d,null,[s("div",null,[n(s("input",{type:"range",class:"hire",min:"0",max:l(m).Kojania.availableWarriors,"onUpdate:modelValue":e[0]||(e[0]=a=>l(m).tohire=a)},null,8,w),[[r,l(m).tohire,void 0,{number:!0}]]),s("button",{onClick:e[1]||(e[1]=a=>l(m).tohire=l(m).Kojania.availableWarriors),id:"allBtn"},"max")]),s("p",null,"К найму: "+i(l(m).tohire)+" || На сумму: "+i(l(m).tohire*l(m).Kojania.hirecost),1),s("button",{onClick:e[2]||(e[2]=a=>l(u).dispatch("hire",l(m).tohire)),id:"hireBtn"},"Нанять")],64))}});const C=s("br",null,null,-1),_=c(" | "),R=s("br",null,null,-1),q=s("label",{for:"rangUp"},"готовых к повешению",-1),x=s("br",null,null,-1),j=s("label",{for:"rangDown"},"не готовых к повышению ",-1),P=s("br",null,null,-1),K=s("label",{for:"all"},"всех",-1),L=s("div",null,null,-1),S=s("hr",{id:"niceLine2"},null,-1);const G={data:()=>({dictS:{smerd:"smerds",dubolom:"duboloms",warrior:"warriors",veteran:"veterans",knight:"knights",hero:"heroes"}}),props:["name"],methods:{}},I=Object.assign(G,{setup:function(r){const d=a(),m=e((()=>d.state.Entity));return(a,e)=>(t(),o("div",null,[s("div",null,[s("div",null,[c(i(l(m).Dict[a.dictS[r.name]])+":",1),C,c(" В отряде: "+i(l(m).squad[r.name])+" / "+i(l(m).squad_imp[r.name])+"↑ | В резерве: "+i(l(m).squadReserved[r.name])+" / "+i(l(m).squad_imp_reserv[r.name])+"↑ "+i()+" ",1),s("div",null,[s("button",{class:"closeCartButton min-w40",onClick:e[0]||(e[0]=a=>l(d).dispatch("takeReserve",{mode:l(m).radioReservSelect,name:r.name}))},"Забрать"),_,s("button",{class:"closeCartButton min-w40",onClick:e[1]||(e[1]=a=>l(d).dispatch("takeSquad",{mode:l(m).radioReservSelect,name:r.name}))},"Отослать"),R,n(s("input",{class:"radio",type:"radio","onUpdate:modelValue":e[2]||(e[2]=a=>l(m).radioReservSelect=a),name:"smerd",value:"rangUp",id:"rangUp"},null,512),[[u,l(m).radioReservSelect]]),q,x,n(s("input",{class:"radio",type:"radio","onUpdate:modelValue":e[3]||(e[3]=a=>l(m).radioReservSelect=a),name:"smerd",value:"rangDown",id:"rangDown"},null,512),[[u,l(m).radioReservSelect]]),j,P,n(s("input",{class:"radio",type:"radio","onUpdate:modelValue":e[4]||(e[4]=a=>l(m).radioReservSelect=a),name:"smerd",value:"all",id:"all"},null,512),[[u,l(m).radioReservSelect]]),K])]),L]),S]))}});const D=s("br",null,null,-1),H=c(" Охоты: "),T={class:"num"},N=s("br",null,null,-1),E=c(" Гарнизон: "),Q={class:"num"},W=s("br",null,null,-1),A=c(" Контракты: "),B={class:"num"},O=s("br",null,null,-1),F=s("hr",{id:"niceLine2"},null,-1),V=c(" Жалование: "),U={class:"num"},z=s("br",null,null,-1),$=c(" Найм: "),J={class:"num"},X=s("br",null,null,-1),Y=c(" Продвижение: "),Z={class:"num"},aa=s("br",null,null,-1),ea=s("br",null,null,-1);const ta={data:()=>({}),props:["period"],methods:{}},oa=Object.assign(ta,{setup:function(n){const r=a(),d=e((()=>r.state.Entity));return(a,e)=>(t(),o("div",null,[s("div",null,[s("div",null,[D,H,s("span",T,i(l(d).goldHist.Inc.hunt[n.period].toLocaleString()),1),N,E,s("span",Q,i(l(d).goldHist.Inc.reserv[n.period].toLocaleString()),1),W,A,s("span",B,i(l(d).goldHist.Inc.contracts[n.period].toLocaleString()),1),O,F,V,s("span",U,i(l(d).goldHist.Cost.payday[n.period].toLocaleString()),1),z,$,s("span",J,i(l(d).goldHist.Cost.hire[n.period].toLocaleString()),1),X,Y,s("span",Z,i(l(d).goldHist.Cost.upg[n.period].toLocaleString()),1),aa,ea])])]))}});const sa={key:0,class:"modal-mask"},na={class:"modal-wrapper"},ra={class:"modal-position"},la={id:"contracts-block"},ia={id:"contractTable"},da=s("tr",null,[s("th",null,"Тип"),s("th",null,"Мин. мощь"),s("th",null,"Реком. мощь"),s("th")],-1),ca={key:0},ua=["onClick"],ma={class:"modal-mask"},pa={class:"modal-wrapper"},ha={class:"modal-position"},ga={id:"mission-block"},va={id:"plus"},ba=s("hr",null,null,-1),fa={class:"missionText"},ya=s("br",null,null,-1),wa={class:"modal-mask"},ka={class:"modal-wrapper"},Ma={class:"modal-position"},Ca={id:"reserv-block"},_a=["onClick","disabled"],Ra={key:0},qa={key:1},xa=s("p",{style:{"margin-top":"8px"}},"Общий резерв:",-1),ja=s("hr",null,null,-1),Pa=s("p",null,"Расширение гарнизона:",-1),Ka=c(" | "),La=s("hr",null,null,-1),Sa={class:"modal-mask"},Ga={class:"modal-wrapper"},Ia={class:"modal-position"},Da={id:"moral-block"},Ha=c(" Изменения морали:"),Ta=s("br",null,null,-1),Na=s("div",null,[s("span",{class:"floatL"},"Базовая:"),s("span",{class:"floatR"},"50")],-1),Ea=s("br",null,null,-1),Qa={key:0},Wa=s("span",{class:"floatL"},"Известность:",-1),Aa={class:"floatR"},Ba=s("br",null,null,-1),Oa={key:1},Fa=s("span",{class:"floatL"},"Победы:",-1),Va={class:"floatR"},Ua=s("br",null,null,-1),za={key:2},$a=s("span",{class:"floatL"},"Спокойные дни:",-1),Ja={class:"floatR"},Xa=s("br",null,null,-1),Ya={key:3},Za=s("span",{class:"floatL"},"Богатство:",-1),ae={class:"floatR"},ee=s("br",null,null,-1),te=s("hr",null,null,-1),oe={key:4},se=s("span",{class:"floatL"},"Поражения:",-1),ne={class:"floatR"},re=s("br",null,null,-1),le={key:5},ie=s("span",{class:"floatL"},"Человеческие потери:",-1),de={class:"floatR"},ce=s("br",null,null,-1),ue={key:6},me=s("span",{class:"floatL"},"Боевоя мощь утрачена:",-1),pe={class:"floatR"},he=s("br",null,null,-1),ge={key:7},ve=s("span",{class:"floatL"},"Долг людям:",-1),be={class:"floatR"},fe=s("br",null,null,-1),ye={key:8},we=s("span",{class:"floatL"},"Размер отряда:",-1),ke={class:"floatR"},Me=s("br",null,null,-1),Ce={class:"modal-mask"},_e={class:"modal-wrapper"},Re={class:"modal-position"},qe={id:"finance-block"},xe=["onClick"],je={class:"modal-mask"},Pe=[s("div",{class:"modal-wrapper"},[s("div",{class:"modal-position"},[s("div",{id:"final-score-block"})])],-1)],Ke={class:"modal-mask"},Le={class:"modal-wrapper"},Se={class:"modal-position"},Ge={id:"error-block"},Ie=s("br",null,null,-1);const De={data:()=>({currentTab:"smerd",tabs:["smerd","dubolom","warrior","veteran","knight","hero"],period:"week",tabs_f:["week","month","all"]})},He=Object.assign(De,{setup:function(r){const u=a(),b=e((()=>u.state.Entity));return(a,e)=>(t(),o(d,null,[l(b).modalContracts?(t(),o("div",sa,[s("div",na,[s("div",ra,[s("div",la,[s("table",ia,[da,(t(!0),o(d,null,m(l(b).contract_list,((a,e)=>(t(),o("tbody",null,[l(b).contracts[a.dif].isAvailable?(t(),o("tr",ca,[s("td",null,i(l(b).Dict[a.dif]),1),s("td",null,i(a.minPower),1),s("td",null,i(a.recommendedPower),1),s("td",null,[s("button",{class:"closeCartButton",onClick:t=>l(u).dispatch("takeContract",{contract:a,index:e})},"Принять",8,ua)])])):p("",!0)])))),256))]),s("button",{class:"closeCartButton",onClick:e[0]||(e[0]=a=>l(b).modalContracts--)},"Пожалуй не сейчас...")])])])])):p("",!0),n(s("div",ma,[s("div",pa,[s("div",ha,[s("div",ga,[(t(!0),o(d,null,m(l(b).niceQuestMsgs,((a,e)=>(t(),o("p",va,i(a),1)))),256)),ba,(t(!0),o(d,null,m(l(b).modalMissionParagraphs,((a,e)=>(t(),o("p",fa,i(a),1)))),256)),ya,s("button",{class:"closeCartButton",onClick:e[1]||(e[1]=a=>l(b).modalMission--)},"Понимаю")])])])],512),[[h,l(b).modalMission]]),n(s("div",wa,[s("div",ka,[s("div",Ma,[s("div",Ca,[(t(!0),o(d,null,m(a.tabs,((e,s)=>(t(),o("button",{key:e,class:g(["tab-button",{active:a.currentTab===e}]),onClick:t=>a.currentTab=e,disabled:!(l(b).wa[e]>0)},[l(b).wa[e]>0?(t(),o("span",Ra,i(l(b).rangName[e])+i(),1)):(t(),o("span",qa,"???"))],10,_a)))),128)),xa,c(" "+i(l(u).getters.totalReserved)+" из "+i(l(b).reservCapacity)+" ",1),s("p",null,"Ежедневный доход от гарнизона: "+i(l(u).getters.reservTax),1),s("p",null,"Ежедневный опыт гарнизона: "+i(l(u).getters.reservExp),1),ja,v(I,{name:a.currentTab},null,8,["name"]),Pa,s("button",{class:"closeCartButton min-w40",onClick:e[2]||(e[2]=a=>l(u).dispatch("buyReservSpace",1))},"+1 "),Ka,s("button",{class:"closeCartButton min-w40",onClick:e[3]||(e[3]=a=>l(u).dispatch("buyReservSpace",10))},"+10"),s("p",null,"Цена 1 места: "+i(l(b).costReservPlace),1),s("p",null,"Цена 10 мест: "+i(l(b).costReservPlacex10),1),La,s("button",{class:"closeCartButton",onClick:e[4]||(e[4]=a=>l(b).modalReservation--)},"Готово")])])])],512),[[h,l(b).modalReservation]]),n(s("div",Sa,[s("div",Ga,[s("div",Ia,[s("div",Da,[Ha,Ta,s("div",null,[Na,Ea,l(u).getters.moralRenown>0?(t(),o("div",Qa,[Wa,s("span",Aa,"+"+i(l(u).getters.moralRenown),1),Ba])):p("",!0),l(b).moralModifiers.Victory>0?(t(),o("div",Oa,[Fa,s("span",Va,"+"+i(l(b).moralModifiers.Victory),1),Ua])):p("",!0),l(b).moralModifiers.smallVictory>0?(t(),o("div",za,[$a,s("span",Ja,"+"+i(l(b).moralModifiers.smallVictory),1),Xa])):p("",!0),l(u).getters.moralRich>0?(t(),o("div",Ya,[Za,s("span",ae,"+"+i(l(u).getters.moralRich),1),ee])):p("",!0),te,l(b).moralModifiers.Defeat>0?(t(),o("div",oe,[se,s("span",ne,"-"+i(l(b).moralModifiers.Defeat),1),re])):p("",!0),l(b).moralModifiers.humanLost>0?(t(),o("div",le,[ie,s("span",de,"-"+i(l(b).moralModifiers.humanLost),1),ce])):p("",!0),l(b).moralModifiers.powerLost>0?(t(),o("div",ue,[me,s("span",pe,"-"+i(l(b).moralModifiers.powerLost),1),he])):p("",!0),l(b).moralModifiers.powerLost<0?(t(),o("div",ge,[ve,s("span",be,i(l(u).getters.moralDept),1),fe])):p("",!0),l(u).getters.moralSquadSize>0?(t(),o("div",ye,[we,s("span",ke,"-"+i(l(u).getters.moralSquadSize),1),Me])):p("",!0)]),s("button",{class:"closeCartButton",onClick:e[5]||(e[5]=a=>l(b).modalMoral--)},"Готово")])])])],512),[[h,l(b).modalMoral]]),n(s("div",Ce,[s("div",_e,[s("div",Re,[s("div",qe,[(t(!0),o(d,null,m(a.tabs_f,((e,n)=>(t(),o("button",{key:e,class:g(["tab-button",{active:a.period===e}]),onClick:t=>a.period=e},[s("span",null,i(e),1)],10,xe)))),128)),v(oa,{period:a.period},null,8,["period"]),s("button",{class:"closeCartButton",onClick:e[6]||(e[6]=a=>l(b).modalFinance--)},"Готово")])])])],512),[[h,l(b).modalFinance]]),n(s("div",je,Pe,512),[[h,l(b).modalFinalScore]]),n(s("div",Ke,[s("div",Le,[s("div",Se,[s("div",Ge,[c(i(l(b).modalErrorText)+" ",1),Ie,s("button",{class:"closeCartButton",onClick:e[7]||(e[7]=a=>l(b).modalError--)},"Понимаю")])])])],512),[[h,l(b).modalError]])],64))}});const Te={class:"tab"},Ne={class:"row"},Ee=s("hr",{id:"niceLine"},null,-1),Qe={class:"rangSpecifics"},We={class:"rangText",id:"plus"},Ae={class:"rangText",id:"minus"},Be=s("br",null,null,-1),Oe=["src"],Fe=s("hr",{id:"niceLine2"},null,-1),Ve={class:"rangText",id:"rangText"};const Ue={data:()=>({rangInfo:{smerd:{info:"Иногда попадаются толковые ребята. Но в среднем -- пушечное мясо, готовое обмочить штанишки при виде чуть грозного противника.",plus:["Дешевый","Легко обучается"],minus:["Массово гибнет"],url:"1"},dubolom:{info:"Дуболом отличился высоким боевым духом. Мастерство и экипировка все еще могут оставлять желать лучшего, но, по крайней мере, он не подводет в сложный и отвественный момент.",plus:["Неприхотлив","Обучение без рисков"],minus:["Слегка высокая смертность"],url:"2"},warrior:{info:"Воин звучит гордо. Хорошие навыки, разнообразное и качественное снаряжение, а так же непоколебимость -- это звание получают не просто так.",plus:["Сильный боец","Низкая смертность"],minus:["Обучение в бою"],url:"3"},veteran:{info:"Ветераны нашли способ пройти путь воина и сохранить большую из своих частей тела. Приобрели внушительную гибкость в снаряжении и умение выпутываться из сложной ситуации. Великолепные боевые навыки. Готовность успешно выполнить любой, самый безумный приказ. Хотя и это не предел.",plus:["Сильный боец","Очень низкая смертность"],minus:["Высокое содержание","Обучение в бою"],url:"4"},knight:{info:"Человеческая элита, лучшие из лучших. Без отваги на поле боя, граничащей с безумием, до этого ранга не дойти. Самые лучшие трофеи, в первую очередь, попадут в их загребущие до интересностей рученки. Качество их снаряжения, как и расходы в золоте, взлетают до запредельного уровня.",plus:["Очень сильный боец","Крайне живучий гад"],minus:["Очень высокое содержание","Обучается в сложных битвах"],url:"5"},hero:{info:"Специализация героев может быть самой разной. Умения на грани здравого смысла. Сотни и тысячи поверженных врагов на личном счету. Различные могущественные артефакты -- все это обязательные атрибуты Героев.",plus:["Сила не поддается описанию","Условно бессмертен"],minus:["Безумно сложное обучение"],url:"6"}},rangName:{smerd:"Рекрут",dubolom:"Дуболом",warrior:"Воин",veteran:"Ветеран",knight:"Рыцарь",hero:"Герой"}}),props:["name"],methods:{}},ze=Object.assign(Ue,{setup:function(n){const r=a(),c=e((()=>r.state.Entity));return(a,e)=>{return t(),o("div",Te,[s("div",Ne,[s("div",null,[s("h2",null,i(l(c).rangName[n.name]),1),Ee,s("div",Qe,[(t(!0),o(d,null,m(a.rangInfo[n.name].plus,(a=>(t(),o("p",We,"+ "+i(a),1)))),256)),(t(!0),o(d,null,m(a.rangInfo[n.name].minus,(a=>(t(),o("p",Ae,"- "+i(a),1)))),256)),Be,s("p",null,"Cодержание: "+i(l(c).wpc[n.name]),1)])]),s("div",null,[s("div",null,[s("img",{id:"pic",src:(r=a.rangInfo[n.name].url,new URL({"./rang-avarars/1.png":"/Kojania/assets/1.ea454ab5.png","./rang-avarars/2.png":"/Kojania/assets/2.c8991c68.png","./rang-avarars/3.png":"/Kojania/assets/3.72bd031c.png","./rang-avarars/4.png":"/Kojania/assets/4.7cf7f6ff.png","./rang-avarars/5.png":"/Kojania/assets/5.30a644bf.png","./rang-avarars/6.png":"/Kojania/assets/6.bd119c05.png"}[`./rang-avarars/${r}.png`],window.location).href),alt:"",srcset:""},null,8,Oe)])])]),Fe,s("p",Ve,i(a.rangInfo[n.name].info),1),s("button",{class:"closeCartButton",onClick:e[0]||(e[0]=a=>l(c).show.rangInfo=!1)},"Закрыть")]);var r}}});const $e={class:"modal-position",style:{"margin-left":"-185px"}},Je={id:"tab-buttons-cont"},Xe=["onClick","disabled"],Ye={key:0},Ze={key:1};const at={components:{RangCart:ze},data:()=>({currentTab:"smerd",tabs:["smerd","dubolom","warrior","veteran","knight","hero"]})},et=Object.assign(at,{setup:function(n){const r=a(),c=e((()=>r.state.Entity));return(a,e)=>(t(),o("div",$e,[s("div",Je,[(t(!0),o(d,null,m(a.tabs,((e,s)=>(t(),o("button",{key:e,class:g(["tab-button",{active:a.currentTab===e}]),onClick:t=>a.currentTab=e,disabled:!(l(c).wa[e]>0)},[l(c).wa[e]>0?(t(),o("span",Ye,i(l(c).rangName[e])+i(),1)):(t(),o("span",Ze,"???"))],10,Xe)))),128))]),v(ze,{name:a.currentTab},null,8,["name"])]))}});const tt={id:"content"},ot={id:"localContainerPositioner"},st={id:"local"},nt={id:"goalContainerPositioner"},rt={id:"goalContainer"},lt={align:"left"},it={id:"globalInfoRow"},dt=s("hr",{class:"svl"},null,-1),ct=s("hr",{class:"svl"},null,-1),ut=s("hr",null,null,-1),mt={id:"globalInfoRow"},pt=s("hr",{class:"svl"},null,-1),ht=s("hr",{class:"svl"},null,-1),gt={id:"contentPositioner"},vt={class:"kojaniaCont"},bt=s("h3",null,"Кожания",-1),ft=c("Отношения: "),yt=c("Уровень процветания: "),wt=c(" Демоническая угроза: "),kt=c("Цена рекрута: "),Mt=s("br",null,null,-1),Ct={class:"squadCont"},_t=s("h3",null,"Состав отряда",-1),Rt={class:"squadList"},qt={key:0},xt=["onClick","toolTip"],jt=["onClick","toolTip"],Pt=["onClick","toolTip"],Kt=["onClick","toolTip"],Lt=s("br",null,null,-1),St={class:"modal-mask"},Gt={class:"modal-wrapper"},It={id:"day"},Dt=s("br",null,null,-1),Ht={key:0},Tt=s("hr",null,null,-1),Nt={id:"eventLogCont"},Et=s("h3",null,"События",-1),Qt={class:"ml"},Wt=c(" ..."),At=s("br",null,null,-1),Bt={class:"ml"},Ot=s("hr",null,null,-1),Ft=s("br",null,null,-1);const Vt={data:()=>({local:"ru"}),methods:{l10n(a){return"en"==this.local&&void 0===y[this.local][a]?a:y[this.local][a]}}},Ut=Object.assign(Vt,{setup:function(r){const u=a(),b=e((()=>u.state.Entity));return u.commit("setDict","ru"),(a,e)=>(t(),o("div",tt,[s("div",ot,[s("div",st,[l(b).isDebug?(t(),o("button",{key:0,onClick:e[0]||(e[0]=a=>l(u).commit("setDict","en")),class:"btnex"},"en")):p("",!0),l(b).isDebug?(t(),o("button",{key:1,onClick:e[1]||(e[1]=a=>l(u).commit("setDict","ru")),class:"btnex"},"ru")):p("",!0)])]),s("div",nt,[s("div",rt,[s("h3",null,i(l(b).Dict.goal),1),s("p",null,i(l(b).quests[l(b).quests.active].goal),1)])]),s("div",null,[s("h3",lt,i(l(b).Dict.Status),1)]),s("div",it,[s("p",null,i(l(b).Dict.Gold)+": "+i(l(b).gold),1),dt,s("p",null,i(l(b).Dict.Moral)+": "+i(l(u).getters.morality),1),s("button",{class:"moralButton",onClick:e[2]||(e[2]=a=>l(u).commit("openMoralModal"))},"▼"),ct,s("p",null,i(l(b).Dict.Renown)+": "+i(Math.floor(l(b).squadState.reputation)),1)]),ut,s("div",mt,[s("p",null,i(l(b).Dict.Payday)+": "+i(l(b).squadState.paydayleft),1),pt,s("p",null,"Жалование: "+i(l(u).getters.payday),1),ht,s("button",{onClick:e[3]||(e[3]=a=>l(u).commit("openFinanceModal"))},"Финансы")]),s("div",gt,[s("div",vt,[bt,s("p",null,[ft,s("span",{class:g(l(u).getters.kojaniaReputation[1])},i(l(u).getters.kojaniaReputation[0]),3)]),s("p",null,[yt,s("span",{class:g(l(u).getters.kojaniaProsperity[1])},i(l(u).getters.kojaniaProsperity[0]),3)]),s("p",null,[wt,s("span",{class:g(l(u).getters.demonicPresence[1])},i(l(u).getters.demonicPresence[0]),3)]),s("p",null,[kt,s("span",null,i(l(b).Kojania.hirecost),1)]),s("p",null,"Свободные рекруты: "+i(l(b).Kojania.availableWarriors),1),v(M),Mt,n(s("div",null,[s("p",null,"Контракты: "+i(l(b).availableContracts),1),n(s("button",{onClick:e[4]||(e[4]=a=>l(u).commit("openContractList"))},"Прием контрактов",512),[[h,l(b).availableContracts>0]])],512),[[h,l(b).isAvailableContracts&&!l(b).contract_is_taken[3]]]),n(s("p",null,"Принят контракт",512),[[h,l(b).contract_is_taken[0]]]),n(s("p",null,"Принят сложный контракт",512),[[h,l(b).contract_is_taken[1]]]),n(s("p",null,"Принят безумный контракт",512),[[h,l(b).contract_is_taken[2]]])]),s("div",Ct,[_t,(t(!0),o(d,null,m(l(b).squad,((a,e)=>(t(),o("p",Rt,[a>0?(t(),o("div",qt,[c(i(l(b).rangName[e])+": "+i(a)+" ",1),l(b).squad_imp[e]>0&&l(b).wa[e]>1?(t(),o("button",{key:0,onClick:a=>l(u).dispatch("rangUp",{rang:e,count:1}),toolTip:"Стоимость: "+2*l(b).wpc[e],class:"tooltip"}," 1+ ",8,xt)):p("",!0),l(b).squad_imp[e]>=10&&l(b).wa[e]>1?(t(),o("button",{key:1,onClick:a=>l(u).dispatch("rangUp",{rang:e,count:10}),toolTip:"Стоимость: "+2*l(b).wpc[e]*10,class:"tooltip"}," 10+ ",8,jt)):p("",!0),l(b).squad_imp[e]>=100&&l(b).wa[e]>1?(t(),o("button",{key:2,onClick:a=>l(u).dispatch("rangUp",{rang:e,count:100}),toolTip:"Стоимость: "+2*l(b).wpc[e]*100,class:"tooltip"}," 100+ ",8,Pt)):p("",!0),l(b).squad_imp[e]>1&&l(b).wa[e]>1?(t(),o("button",{key:3,onClick:a=>l(u).dispatch("rangUp",{rang:e,count:l(b).squad_imp[e]}),toolTip:"Стоимость: "+l(b).squad_imp[e]*l(b).wpc[e]*2,class:"tooltip"},i(l(b).squad_imp[e])+"+ ",9,Kt)):p("",!0)])):p("",!0)])))),256)),Lt,s("p",null,"Всего людей: "+i(l(u).getters.totalPeople),1),s("p",null,"Боевая мощь: "+i(l(u).getters.power),1),l(b).wa.smerd>0?(t(),o("button",{key:0,onClick:e[5]||(e[5]=a=>l(u).commit("openRangInfo"))},"? о рангах")):p("",!0),l(b).isArmyReserving?(t(),o("button",{key:1,onClick:e[6]||(e[6]=a=>l(u).commit("openReservModal")),class:"btnex"},"Резерв")):p("",!0)])]),n(s("div",St,[s("div",Gt,[v(et)])],512),[[h,l(b).show.rangInfo]]),s("div",null,[s("span",It,"День: "+i(l(b).day),1),Dt,s("button",{onClick:e[7]||(e[7]=a=>l(u).dispatch("toNextDay")),class:"btnex"},"Завершение дня.")]),l(b).isTargetAW?(t(),o("p",Ht,"Прогноз рекрутов на завтра: "+i(l(u).getters.targetAvailableWarriors),1)):p("",!0),Tt,s("div",Nt,[Et,s("p",Qt,i(l(b).messageLog1),1),Wt,At,(t(!0),o(d,null,m(l(b).messageLog2,((a,e)=>(t(),o("p",Bt,i(l(b).messageLog2[e]),1)))),256))]),Ot,l(b).isDebug?(t(),o("button",{key:1,onClick:e[8]||(e[8]=a=>l(u).commit("addRep")),class:"btnex"},"+50 rep")):p("",!0),l(b).isDebug?(t(),o("button",{key:2,onClick:e[9]||(e[9]=a=>l(u).commit("addx2Rep")),class:"btnex"},"x2 rep")):p("",!0),l(b).isDebug?(t(),o("button",{key:3,onClick:e[10]||(e[10]=a=>l(u).commit("addRen")),class:"btnex"},"+50 ren")):p("",!0),l(b).isDebug?(t(),o("button",{key:4,onClick:e[11]||(e[11]=a=>l(u).commit("addGold")),class:"btnex"},"x10 gold")):p("",!0),l(b).isDebug?(t(),o("button",{key:5,onClick:e[12]||(e[12]=a=>l(u).commit("addDaemons")),class:"btnex"},"x2 daemons")):p("",!0),l(b).isDebug?(t(),o("button",{key:6,onClick:e[13]||(e[13]=a=>l(u).commit("addArmy")),class:"btnex"},"addArmy")):p("",!0),l(b).isDebug?(t(),o("button",{key:7,onClick:e[14]||(e[14]=a=>l(b).day+=100),class:"btnex"},"+100Days")):p("",!0),Ft,l(b).isDebug?(t(),o("button",{key:8,onClick:e[15]||(e[15]=a=>l(u).dispatch("showWhatHiden")),class:"btnex"},"showWhatHiden()")):p("",!0),v(He)]))}});const zt=b({modules:{Entity:{state:()=>({local:"ru",day:1,gold:1120,lastMonthGoldHist:{Inc:{hunt:[0],reserv:[0],contracts:[0]},Cost:{hire:[0],upg:[0],payday:[0]},other:[0]},goldHist:{Inc:{hunt:{week:0,month:0,all:0},reserv:{week:0,month:0,all:0},contracts:{week:0,month:0,all:0}},Cost:{hire:{week:0,month:0,all:0},upg:{week:0,month:0,all:0},payday:{week:0,month:0,all:0}},Other:{Total:{week:0,month:0,all:0}}},show:{rangInfo:!1},squadState:{paydayleft:6,morality:50,reputation:0},squad:{smerd:6,dubolom:0,warrior:0,veteran:0,knight:0,hero:0},tohire:0,wa:{smerd:0,dubolom:0,warrior:0,veteran:0,knight:0,hero:0},wpc:{smerd:7,dubolom:12,warrior:35,veteran:100,knight:300,hero:2e3},wp:{smerd:10,dubolom:16,warrior:32,veteran:50,knight:100,hero:700},wdc:{smerd:40,dubolom:16,warrior:7,veteran:3,knight:2,hero:.01},warriorsdie:{smerd:0,dubolom:0,warrior:0,veteran:0,knight:0,hero:0},exp:{smerd:[180,0],dubolom:[600,0],warrior:[1200,0],veteran:[3e3,0],knight:[18e3,0],hero:[1e6,0]},expbaseinc:{smerd:[1,3,6,15],dubolom:[2,6,16,36],warrior:[3,12,24,72],veteran:[4,16,48,108],knight:[5,20,90,270],hero:[0,0,0,0]},expreward:0,squad_imp:{smerd:0,dubolom:0,warrior:0,veteran:0,knight:0,hero:0},squadReserved:{smerd:0,dubolom:0,warrior:0,veteran:0,knight:0,hero:0},squad_imp_reserv:{smerd:0,dubolom:0,warrior:0,veteran:0,knight:0,hero:0},reservCapacity:10,costReservPlace:0,costReservPlacex10:0,radioReservSelect:"all",expReserv:{smerd:0,dubolom:0,warrior:0,veteran:0,knight:0,hero:0},reservPaymentCoef:.8,Kojania:{demonicPresence:30,demonicPresenceList:[{num:200,className:"white-grade",text:"редкие одиночные цели"},{num:1e3,className:"green-grade",text:"редкие малые стаи"},{num:2500,className:"yellow-grade",text:"возможны крупные стаи"},{num:5e3,className:"red-grade",text:"орды демонов"},{num:9e3,className:"black-grade",text:"чудовищные орды демонов"}],prosperity:250,prosperityList:[{num:50,className:"black-grade",text:"пепелище"},{num:200,className:"red-grade",text:"восстановление"},{num:1e3,className:"yellow-grade",text:"укрепление"},{num:2500,className:"green-grade",text:"стабильность"},{num:5e3,className:"white-grade",text:"экспансия"}],reputation:0,repSumm:0,reputationGain:[],reputationList:[{num:108,className:"yellow-grade",text:"нейтральные"},{num:250,className:"green-grade",text:"открытые"},{num:1e3,className:"white-grade",text:"теплые"},{num:5e3,className:"white-grade",text:"дружеские"},{num:1e4,className:"white-grade",text:"союзные"}],goldBonus:1,enemyBonus:1,availableWarriors:1,targetAvailableWarriors:2,baseHireCost:140,hirecost:14},questsChanceMlps:{common:1,hard:1,madness:1},messageLog1:"",messageLog2:[],battleReport:{result:{key:0,text:[]},gold:0,exp:0},Dict:{},info:["Демоны -- крайне опасные существа. Даже слабейший из них, за счет невероятной грубой силы и живучести, требует слаженной работы десятка людей. У них множество подвидов с различными особенностями. Но, как правило, дальнобойное оружие и добротные копья делают свое дело. По возможности лучше использовать ловушки и не допускать сближения.","Тушки демонов пользуются хорошим спросом. Почти каждую часть их тела можно считать стратегическим ресурсом. Кроме съедобного мяса это отличные доспехи из кожи. Вполне боеспособные луки и арбалеты из прочных связок. Невероятно огромный список амуниции из костей. Каждый участник охоты или сражения получает часть прибыли с этих трофеев."],quests:{active:"hire_10_smerd",hire_10_smerd:{goal:"Нанять 10 рекрутов",finishText:"Рекруты набираются опыта в бою и на тренировке. При продвижении придется заплатить разовое 2х недельное жалование. Боец улучшит снаряжение и станет сильнее уже в следующем бою.",niceQuestMsgs:["Можно продвигать рекрутов.","Доступны простые контракты."]},found_contract:{goal:"Выполнить контракт.",finishText:"Время от времени будут появляться различные контракты. Их выполнение важно как для Кожании так и для нас. Хотя мы и не обязаны под этим подписываться, без Кожании у нас мало шансов. |Заказчик укажет минимальные требования и ожидаемые проблемы... Реальность же может превзойти самые безумные ожидания. Если мы не хотим потерять все, нам придется быть к этому, по возможности, готовыми.",niceQuestMsgs:["Получено 500 золота.","Доступны сложные контракты."]},take_3000_gold:{goal:"3000 золота и 500 мощи",finishText:"Местный староста -- солидный господин. Он весьма снисходителен к гостям и готов бесплатно предоставлять некоторый уровень безопасности. Правда, вне центральной крепости, которая с каждым днем становится все более массивной. |Под крепостью так же есть развитая подземная инфраструктура, где мы можем выкупить самые надежные места для гарнизона, тем самым расширяя наши возможности.",niceQuestMsgs:["Отдана 1000 золота, отношения улучшились.","Доступен прогноз рекрутов на следующий день.","Доступно резервирование отрядов."]},found_hard_contract:{goal:"Выполнить сложный контракт.",finishText:"На успешность любых предприятий сильно влияет мораль отряда. Особенно при столкновении с превосходящими силами противника. |Люди больше склонны помнить плохое. По возможности стоит сводить человеческие потери к минимуму. Чем больше у нас людей, тем сложнее врагу убить хотя бы одного человека и тем меньше значит его потеря. |Если не считаться с моралью, последствия либо обернутся катастрофой, либо отряд развалится сам по себе.",niceQuestMsgs:["Получено 2000 золота.","Проветание Кожании растет.","Можно продвигать дуболомов."]},take_20_warriors:{goal:"20 воинов и 3000 мощи",finishText:"В Кожании огромные проблемы с металлами. Придется захватить и обустроить рудные шахты, расположенные далеко от поселения. |Для обычных людей это станет чистым самоубийством. Игнорирование проблемы может привевести к еще более худшему результату.",niceQuestMsgs:["Можно продвигать воинов","Доступны безумные контракты."]},take_10_veterans:{goal:"10 ветеранов и 5000 мощи",finishText:"Наша известность работает в обе стороны. |В прославленный отряд присоединяется больше людей и этими людьми проще управлять. Нам доверяют самое лучшие оружие и щедро платят за трофеи. |Однако чем дольше мы сидим на одном месте, тем больше внимания в округе привлекаем. К каждому контракту следует относиться с особой осторожностью.",niceQuestMsg1:"Можно продвигать ветеранов",niceQuestMsgs:["Можно продвигать ветеранов.","Прогноз силы врага в контрактах более точен.","Доход от гарнизона увеличен."]},take_10_knights:{goal:"10 рыцарей и 9000 мощи",finishText:"Туши убитых демонов полны сюрпризов. Металлурги и алхимики делают исключительные открытия и создают невероятные вещи. Конечно, кто-то должен эти туши добыть, как правило ценой своих жизней, а потом кто-то должен с ними как следует поработать. Но в такие времена сам факт прогресса уже вселяет надежду.",niceQuestMsgs:["Можно продвигать рыцарей.","Доход от гарнизона увеличен."]},take_10_heroes:{goal:"10 героев и 40к мощи",finishText:"Победа (нет)",niceQuestMsgs:[""]}},isAvailableContracts:!1,contracts:{common:{isAvailable:!1,generationChance:[12,12],revard:{first:200,loot:20},prosperityChange:6,reputationCnange:8,chancetoLose:[0,10],basePower:50,scaleRange:6},hard:{isAvailable:!1,generationChance:[5,5],revard:{first:600,loot:35},prosperityChange:10,reputationCnange:16,chancetoLose:[0,4],basePower:300,scaleRange:4},madness:{isAvailable:!1,generationChance:[2,2],revard:{first:1800,loot:50},prosperityChange:20,reputationCnange:32,chancetoLose:[0,2],basePower:1e3,scaleRange:3}},contract_list:[],availableContracts:0,contract_is_taken:[0,0,0,0],rangName:{smerd:"Рекрут",dubolom:"Дуболом",warrior:"Воин",veteran:"Ветеран",knight:"Рыцарь",hero:"Герой"},moralEvents:{Victory:[],Defeat:[],smallVictory:[],humanLost:[],powerLost:[]},moralModifiers:{Victory:0,Defeat:0,smallVictory:0,humanLost:0,powerLost:0},moralBattleCoef:0,isTargetAW:!1,isArmyReserving:!1,modalError:!1,modalMission:!1,modalContracts:!1,modalReservation:!1,modalMoral:!1,modalFinance:!1,modalFinalScore:!1,modalErrorText:"",modalMissionText:"",modalMissionParagraphs:[],niceQuestMsgs:[],takenContract:{},isDebug:!1}),mutations:{moralManager(a,e){let t=0;for(let n in a.warriorsdie)t+=a.warriorsdie[n]*a.wp[n];let o=t/(e.power+t);if(o>.15){const e=Math.floor(30*o);a.moralEvents.powerLost.push([e,14])}["Victory","smallVictory","Defeat","humanLost","powerLost"].forEach((e=>{a.moralModifiers[e]=0,a.moralEvents[e].forEach(((t,o,s)=>{a.moralModifiers[e]+=t[0],t[1]--,t[1]<=0&&s.splice(o,1)}))}));const s=a.squadState.morality;a.moralBattleCoef=s<25?1-(50-s+(25-s))/100:s<50?1-(50-s)/100:s<75?1+(s-50)/100:1+(s-50+s-75)/100},setDict(a,e){a.Dict=y[e];for(const t in y.en)void 0===a.Dict[t]&&(a.Dict[t]=y.en[t])},toNextDay(a){a.day++,a.squadState.paydayleft--,a.Kojania.demonicPresence+=.01*a.Kojania.demonicPresence+1},hire(a,e){a.squad.smerd+=e,a.gold-=a.Kojania.hirecost*e,a.Kojania.availableWarriors-=e},hire_reset_helper(a,e){a.Kojania.availableWarriors<e&&(a.tohire=a.Kojania.availableWarriors)},buyReservSpace(a,e){a.reservCapacity+=e,a.costReservPlace=50+5*(a.reservCapacity-20),a.costReservPlacex10=275+10*(50+5*(a.reservCapacity-20))},availableWarriors(a){a.Kojania.availableWarriors=Math.floor(a.Kojania.availableWarriors*Math.min(.6*(1+Math.pow(a.Kojania.prosperity,.5)/100),1)+Math.random()*Math.pow(a.Kojania.reputation+10,.7)),a.Kojania.availableWarriors<a.tohire&&(a.tohire=a.Kojania.availableWarriors)},rangUp(a,{rang:e,count:t}){switch(a.squad_imp[e]-=t,a.squad[e]-=t,e){case"smerd":a.squad.dubolom+=t;break;case"dubolom":a.squad.warrior+=t;break;case"warrior":a.squad.veteran+=t;break;case"veteran":a.squad.knight+=t;break;case"knight":a.squad.hero+=t}},reputationCalc(a){a.Kojania.repSumm=a.Kojania.reputation+a.squadState.reputation,a.Kojania.repSumm<0&&(a.Kojania.reputation=0,a.Kojania.repSumm=a.Kojania.reputation+a.squadState.reputation),a.Kojania.hirecost=Math.round(Math.min(14,Math.max(2,a.Kojania.baseHireCost/Math.pow(a.Kojania.repSumm,.5)))),a.Kojania.goldBonus=Math.min(1+Math.pow(a.Kojania.repSumm,.75)/100,7),a.Kojania.enemyBonus=Math.min(1+Math.pow(a.squadState.reputation,.8)/100,20)},reset(a){Object.entries(a.warriorsdie).forEach(((e,t,o)=>{a.warriorsdie[e[0]]=0}))},clearLog(a){a.messageLog1="",a.messageLog2.length=0},summFinance:(a,e)=>{let t=7,o=30;const s=e.split(".");a.goldHist[s[0]][s[1]].all=0,a.goldHist[s[0]][s[1]].week=0,a.goldHist[s[0]][s[1]].month=0;for(let n=a.lastMonthGoldHist[s[0]][s[1]].length-1;n>=0;n--)a.goldHist[s[0]][s[1]].all+=a.lastMonthGoldHist[s[0]][s[1]][n],t>0&&(a.goldHist[s[0]][s[1]].week+=a.lastMonthGoldHist[s[0]][s[1]][n]),o>0&&(a.goldHist[s[0]][s[1]].month+=a.lastMonthGoldHist[s[0]][s[1]][n]),t--,o--},openContractList(a){a.modalContracts=!0},openRangInfo(a){a.show.rangInfo=!0},openReservModal(a){a.modalReservation=!0},openMoralModal(a){a.modalMoral=!0},openFinanceModal(a){a.modalFinance=!0},openFinalScore(a){a.modalFinalScore=!0},error(a,e){a.modalErrorText=e,a.modalError=!0},addGold(a){a.gold*=10},addRep(a){a.Kojania.reputation+=50,console.log(a.Kojania.reputation)},addRen(a){a.squadState.reputation+=50,console.log(a.squadState.reputation)},addx2Rep(a){a.Kojania.reputation*=2,console.log(a.Kojania.reputation)},addDaemons(a){a.Kojania.demonicPresence*=2,console.log(a.Kojania.demonicPresence)},addArmy(a){for(let e in a.squad)a.squad[e]+=2,a.squad[e]*=2}},actions:{async toNextDay({commit:a,state:e,getters:t,dispatch:o}){a("clearLog"),a("toNextDay"),o("financeHelper"),0==e.squadState.paydayleft&&o("time2Pay",t.payday),a("availableWarriors"),o("garnisonManager",t.reservTax),o("checkQuest"),o("generateContracts"),await o("battlesimulation"),a("reputationCalc"),o("contractManager"),a("moralManager",t),a("reset")},financeHelper({state:a,commit:e}){a.lastMonthGoldHist.Cost.hire[a.day-1]=0,a.lastMonthGoldHist.Inc.reserv[a.day-1]=0,a.lastMonthGoldHist.Inc.hunt[a.day-1]=0,a.lastMonthGoldHist.Inc.contracts[a.day-1]=0,a.lastMonthGoldHist.Cost.upg[a.day-1]=0,a.lastMonthGoldHist.Cost.payday[a.day-1]=0,["Cost.hire","Inc.reserv","Inc.hunt","Inc.contracts","Cost.payday","Cost.upg"].forEach((a=>{e("summFinance",a)}))},garnisonManager({state:a,commit:e},t){a.gold+=t,isNaN(a.lastMonthGoldHist.Inc.reserv[a.day-1])&&(a.lastMonthGoldHist.Inc.reserv[a.day-1]=0),a.lastMonthGoldHist.Inc.reserv[a.day-1]+=t,e("summFinance","Inc.reserv");for(const o in a.squadReserved)if(a.squad_imp_reserv[o]<a.squadReserved[o]&&(a.expReserv[o]+=a.expbaseinc[o][0]*a.squadReserved[o],a.expReserv[o]>a.exp[o][0])){const e=Math.floor(a.expReserv[o]/a.exp[o][0]);a.squad_imp_reserv[o]+=e,a.expReserv[o]-=e*a.exp[o][0]}},time2Pay({state:a,commit:e},t){a.squadState.paydayleft+=7,a.gold-=t,isNaN(a.lastMonthGoldHist.Cost.payday[a.day-1])&&(a.lastMonthGoldHist.Cost.payday[a.day-1]=0),a.lastMonthGoldHist.Cost.payday[a.day-1]-=t,e("summFinance","Cost.payday")},checkQuest({commit:a,state:e,getters:t,dispatch:o},s){let n=e.quests,r=e.squad;switch(n.active){case"hire_10_smerd":r.smerd>=10&&(o("showQuestMsg",n),e.wa.smerd=2,e.wa.dubolom=1,e.isAvailableContracts=!0,e.contracts.common.isAvailable=!0,n.active="found_contract",o("generateContract",{str:"common",minPower:50,recPw:80,rlPw:90,e:0,f:0,g:5,h:5}).then((a=>{e.contract_list.push(a)})));break;case"found_contract":s&&(o("showQuestMsg",n),e.gold+=500,e.contracts.hard.isAvailable=!0,n.active="take_3000_gold");break;case"take_3000_gold":e.gold>3e3&&t.power>500&&(e.gold-=1e3,e.Kojania.reputation+=50,e.isTargetAW=!0,e.reservCapacity=20,e.costReservPlace=50+5*(e.reservCapacity-20),e.costReservPlacex10=275+10*(50+5*(e.reservCapacity-20)),e.isArmyReserving=!0,o("showQuestMsg",n),o("generateContract",{str:"hard",minPower:400,recPw:850,rlPw:1e3,e:0,f:0,g:5,h:5}).then((a=>{e.contract_list.push(a)})),n.active="found_hard_contract");break;case"found_hard_contract":s&&(o("showQuestMsg",n),e.gold+=2e3,e.Kojania.prosperity+=100,e.wa.dubolom=2,e.wa.warrior=1,n.active="take_20_warriors");break;case"take_20_warriors":r.warrior>=20&&t.power>2e3&&(o("showQuestMsg",n),e.wa.warrior=2,e.wa.veteran=1,e.contracts.madness.isAvailable=!0,n.active="take_10_veterans");break;case"take_10_veterans":r.veteran>=10&&t.power>5e3&&(o("showQuestMsg",n),e.wa.veteran=2,e.wa.knight=1,e.reservPaymentCoef=1,n.active="take_10_knights");break;case"take_10_knights":r.knight>=10&&t.power>9e3&&(o("showQuestMsg",n),e.wa.knight=2,e.wa.hero=1,e.reservPaymentCoef=1.2,n.active="take_10_heroes");break;case"take_10_heroes":r.hero>=10&&t.power}},generateContracts({commit:a,state:e,getters:t,dispatch:o}){let s=e.contracts,n=e.contract_list,r=s.common.generationChance,l=s.common.chancetoLose,i=s.hard.generationChance,d=s.hard.chancetoLose,c=s.madness.generationChance,u=s.madness.chancetoLose;const m=e.Kojania.enemyBonus;if(r[0]=12*e.questsChanceMlps.common,i[0]=5*e.questsChanceMlps.hard,c[0]=2*e.questsChanceMlps.madness,r[1]/100>Math.random()){let a=Math.round((Math.random()*(s.common.scaleRange-1)+1)*s.common.basePower);const t=Math.round(a*(Math.random()/1.5+1)*m);o("generateContract",{str:"common",minPower:a,recPw:t,rlPw:Math.round(.9*t*(1+Math.sqrt(e.Kojania.demonicPresence)/75)),e:l[0],f:l[1],g:s.common.prosperityChange,h:s.common.reputationCnange}).then((a=>{n.push(a)})),r[1]-=100}else r[1]=r[1]+r[0];if(i[1]/100>Math.random()){let a=Math.round((Math.random()*(s.hard.scaleRange-1)+1)*s.hard.basePower);const t=Math.round(a*(Math.random()/1.5+1)*m);o("generateContract",{str:"hard",minPower:a,recPw:t,rlPw:Math.round(.9*t*(1+Math.sqrt(e.Kojania.demonicPresence)/50)),e:d[0],f:d[1],g:s.hard.prosperityChange,h:s.hard.reputationCnange}).then((a=>{n.push(a)})),i[1]-=100}else i[1]=i[1]+i[0];if(c[1]/100>Math.random()){let a=Math.round((Math.random()*(s.madness.scaleRange-1)+1)*s.madness.basePower);const t=Math.round(a*(Math.random()/1.5+1)*m);o("generateContract",{str:"madness",minPower:a,recPw:t,rlPw:Math.round(.9*t*(1+Math.sqrt(e.Kojania.demonicPresence)/25)),e:u[0],f:u[1],g:s.madness.prosperityChange,h:s.madness.reputationCnange}).then((a=>{n.push(a)})),c[1]-=100}else c[1]=c[1]+c[0]},generateContract:(a,{str:e,minPower:t,recPw:o,rlPw:s,e:n,f:r,g:l,h:i})=>({dif:e,minPower:t,recommendedPower:o,realPower:s,chancetoLose:n,changeChance:r,prosperity:l,reputation:i}),contractManager({state:a,dispatch:e}){let t=a.contract_list;a.availableContracts=0;for(const o in t)a.contracts[t[o].dif].isAvailable&&a.availableContracts++,Math.random()<t[o].chancetoLose/100?(a.isDebug&&e("log2","Кожания теряет процветание, "+a.Dict[t[o].dif]+" контракт просрочен."),a.Kojania.prosperity-=t[o].prosperity/2,a.Kojania.prosperity<20&&(a.Kojania.prosperity=20),a.contracts[t[o].dif].isAvailable&&a.availableContracts--,t.splice(o,1)):t[o].chancetoLose+=t[o].changeChance;a.questsChanceMlps.common=Math.min(1+a.day/100,3),a.questsChanceMlps.hard=Math.min(1+a.day/75,6),a.questsChanceMlps.madness=Math.min(1+a.day/50,15)},takeContract({state:a},{contract:e,index:t}){switch(a.takenContract=e,e.dif){case"common":a.contract_is_taken[0]=1,a.contract_is_taken[3]=1;break;case"hard":a.contract_is_taken[1]=1,a.contract_is_taken[3]=1;break;case"madness":a.contract_is_taken[2]=1,a.contract_is_taken[3]=1}a.contract_list.splice(t,1),a.modalContracts--},async battlesimulation({state:a,dispatch:e,getters:t}){if(a.contract_is_taken[3])if(a.takenContract.minPower<t.power){const o=a.takenContract.realPower,s=await e("combatScenario",{enemy:o,ally:t.power});if(a.contract_is_taken[0])if("retreat"==s[0]){e("battleResoult",{msg:"Пришлось отступать. Многие бойцы отдали жизни ради сохранения отряда. Это тяжелый удар.",dif:s[1],ep:o,ep_mlp:3,gold:0,goldMlp:0,reputation:0}),e("expGained",3),e("contractIsOver","fail")}else if("very hard"==s[0]){e("battleResoult",{msg:"Враг был намного сильнее. Но именно в таких битвах куется слава и репутация.",dif:s[1],ep:o,ep_mlp:1.5,gold:200,goldMlp:.7,reputation:12}),e("expGained",3),e("contractIsOver","win")}else if("hard"==s[0]){e("battleResoult",{msg:"Почти равный бой. Приобретен ценный опыт.",dif:s[1],ep:o,ep_mlp:1,gold:200,goldMlp:.7,reputation:5}),e("expGained",2),e("contractIsOver","win")}else e("battleResoult",{msg:"Враг оказался намного слабее нас.",dif:s[1],ep:o,ep_mlp:.4,gold:200,goldMlp:.7,reputation:3}),e("expGained",1),e("contractIsOver","win");else if(a.contract_is_taken[1])if("retreat"==s[0]){e("battleResoult",{msg:"Пришлось отступать. Многие бойцы отдали жизни ради сохранения отряда. Это тяжелый удар.",dif:s[1],ep:o,ep_mlp:3,gold:0,goldMlp:0,reputation:0}),e("expGained",3),e("contractIsOver","fail")}else if("very hard"==s[0]){e("battleResoult",{msg:"Враг был намного сильнее. Но именно в таких битвах куется слава и репутация.",dif:s[1],ep:o,ep_mlp:1.5,gold:600,goldMlp:.9,reputation:18}),e("expGained",3),e("contractIsOver","win")}else if("hard"==s[0]){e("battleResoult",{msg:"Почти равный бой. Приобретен ценный опыт. ",dif:s[1],ep:o,ep_mlp:1,gold:600,goldMlp:.9,reputation:10}),e("expGained",2),e("contractIsOver","win")}else e("battleResoult",{msg:"Враг оказался намного слабее нас.",dif:s[1],ep:o,ep_mlp:.4,gold:600,goldMlp:.9,reputation:8}),e("expGained",1),e("contractIsOver","win");else if("retreat"==s[0]){e("battleResoult",{msg:"Пришлось отступать. Многие бойцы отдали жизни ради сохранения отряда. Это тяжелый удар.",dif:s[1],ep:o,ep_mlp:3,gold:0,goldMlp:0,reputation:0}),e("expGained",3),e("contractIsOver","fail")}else if("very hard"==s[0]){e("battleResoult",{msg:"Враг был намного сильнее. Но именно в таких битвах куется слава и репутация.",dif:s[1],ep:o,ep_mlp:1.5,gold:1800,goldMlp:1,reputation:30}),e("expGained",3),e("contractIsOver","win")}else if("hard"==s[0]){e("battleResoult",{msg:"Почти равный бой. Приобретен ценный опыт. ",dif:s[1],ep:o,ep_mlp:1,gold:1800,goldMlp:1,reputation:20}),e("expGained",2),e("contractIsOver","win")}else e("battleResoult",{msg:"Враг оказался намного слабее нас.",dif:s[1],ep:o,ep_mlp:.4,gold:1800,goldMlp:1,reputation:18}),e("expGained",1),e("contractIsOver","win")}else e("log1","У нас не хватит сил на выполнение контракта."),e("contractIsOver","fail");else{let n=a.Kojania.demonicPresence/a.Kojania.prosperity,r=Math.sqrt(a.Kojania.demonicPresence+100)*n,l=10*r*(1+Math.sqrt(a.squadState.reputation)/10*(1+Math.sqrt(a.Kojania.demonicPresence)/100)),i=(o=r,s=l,Math.random()*(s-o)+o);if(n<1){const a=1-n;if(i<t.power/10){const e=t.power/10;i=Math.min((1+a)*i,e)}}if(t.power>0){let a=await e("combatScenario",{enemy:i,ally:t.power});if("retreat"==a[0]){e("battleResoult",{msg:"Охота обернулась адом для жителей, хотя мы и попытались немного снизить потери.",dif:a[1],ep:i,ep_mlp:2,gold:0,goldMlp:0,reputation:0})}else if("very hard"==a[0]){e("battleResoult",{msg:"Охота превратилась в кровавую битву. Жители благодарны за подаренный им день и готовы щедро заплатить за трофеи.",dif:a[1],ep:i,ep_mlp:1.25,gold:0,goldMlp:1,reputation:8}),e("expGained",3)}else"hard"==a[0]?(e("battleResoult",{msg:"Хоть и было сложно, славная выдалась охота.",dif:a[1],ep:i,ep_mlp:1,gold:0,goldMlp:.7,reputation:3}),e("expGained",2)):"nice battle"==a[0]?(e("battleResoult",{msg:"На патруле возникали небольшие сложности.",dif:a[1],ep:i,ep_mlp:.6,gold:0,goldMlp:.65,reputation:1}),e("expGained",1)):(e("battleResoult",{msg:"Охота и тренировки прошли гладко.",dif:a[1],ep:i,ep_mlp:.5,gold:0,goldMlp:.6,reputation:.25}),e("expGained",0))}}var o,s},battleResoult({state:a,dispatch:e,commit:t},{msg:o,dif:s,ep:n,ep_mlp:r,gold:l,goldMlp:i,reputation:d}){e("log1",o);const c=Math.round((l+n*i)*a.Kojania.goldBonus);c>0&&(e("log2","Получено золота: "+c),a.gold+=c,0==a.contract_is_taken[3]?(isNaN(a.lastMonthGoldHist.Inc.hunt[a.day-1])&&(a.lastMonthGoldHist.Inc.hunt[a.day-1]=0),a.lastMonthGoldHist.Inc.hunt[a.day-1]+=c,t("summFinance","Inc.hunt")):(isNaN(a.lastMonthGoldHist.Inc.contracts[a.day-1])&&(a.lastMonthGoldHist.Inc.contracts[a.day-1]=0),a.lastMonthGoldHist.Inc.contracts[a.day-1]+=c,t("summFinance","Inc.contracts"))),a.squadState.reputation+=d,e("squadLoses",{dif:s,ep_mlp:r})},squadLoses({state:a,dispatch:e,getters:t},{dif:o,ep_mlp:s}){const n=Object.entries(a.squad);let r=!1;if(n.forEach(((e,t,n)=>{const l=Math.floor(Math.min(n[t][1]*a.wdc[n[t][0]]/100*o*s,n[t][1]));l>0&&(r=!0,a.warriorsdie[n[t][0]]=l),a.squad[n[t][0]]-=l})),r){let o=0;for(var l in e("log2","-----"),e("log2","Потери"),a.warriorsdie)a.squad[l]>0?a.squad_imp[l]-=Math.floor(a.warriorsdie[l]*(a.squad_imp[l]/a.squad[l])):a.squad_imp[l]=0,a.warriorsdie[l]>0&&e("log2",a.rangName[l]+": "+a.warriorsdie[l]),o+=a.warriorsdie[l];e("log2","-----");let s=o/(t.totalPeople+o);if(s>.1){e("log2","Всего погибло: "+o);const t=Math.floor(20*s);a.moralEvents.humanLost.push([t,14]),e("log2","Человеческие потери снижают мораль: "+t)}}},combatScenario({state:a},{enemy:e,ally:t}){let o=e/t*a.moralBattleCoef,s=["",o];return o>=2?(s[0]="retreat",a.moralEvents.Defeat.push([5,14])):s[0]=o>=1?"very hard":o>=.5?"hard":o>.1?"nice battle":"ez battle",o<=2&&o>.2?a.moralEvents.Victory.push([3,14]):o<=2&&a.moralEvents.smallVictory.push([2,5]),s},expGained({state:a,dispatch:e},t){let o=0,s=0,n=a.exp;for(const r in a.exp)for(o=a.expbaseinc[r][t]*(a.squad[r]-a.squad_imp[r]),s+=o,n[r][1]+=o;n[r][1]>n[r][0];)a.squad_imp[r]++,n[r][1]-=n[r][0];s>0&&e("log2","Общий опыт: "+s)},rangUp({state:a,commit:e},{rang:t,count:o}){a.gold>o*a.wpc[t]*2?(e("rangUp",{rang:t,count:o}),a.gold-=o*a.wpc[t]*2,isNaN(a.lastMonthGoldHist.Cost.upg[a.day-1])&&(a.lastMonthGoldHist.Cost.upg[a.day-1]=0),a.lastMonthGoldHist.Cost.upg[a.day-1]-=o*a.wpc[t]*2,e("summFinance","Cost.upg")):e("error","Нужно больше золота.")},takeReserve({state:a,dispatch:e},{mode:t,name:o}){if("all"==t)a.squad[o]+=a.squadReserved[o],a.squadReserved[o]=0,a.squad_imp[o]+=a.squad_imp_reserv[o],a.squad_imp_reserv[o]=0;else if("rangUp"==t)a.squad[o]+=a.squad_imp_reserv[o],a.squadReserved[o]-=a.squad_imp_reserv[o],a.squad_imp[o]+=a.squad_imp_reserv[o],a.squad_imp_reserv[o]=0;else{let e=a.squadReserved[o]-a.squad_imp_reserv[o];a.squadReserved[o]-=e,a.squad[o]+=e}},takeSquad({state:a,dispatch:e,getters:t},{mode:o,name:s}){if("all"==o){const e=a.reservCapacity-t.totalReserved;let o=Math.max(Math.min(a.squad[s],e),e);o=Math.min(o,a.squad[s]);let n=a.squad_imp[s];o<n&&(n=o),n=Math.min(o,n),a.squad_imp_reserv[s]+=n,a.squad_imp[s]-=n,a.squadReserved[s]+=o,a.squad[s]-=o}else if("rangUp"==o){const e=a.reservCapacity-t.totalReserved;let o=Math.min(a.squad_imp[s],e);a.squad_imp_reserv[s]+=o,a.squad_imp[s]-=o,a.squadReserved[s]+=o,a.squad[s]-=o}else{const e=a.reservCapacity-t.totalReserved;let o=a.squad[s]-a.squad_imp[s],n=Math.min(o,e);a.squadReserved[s]+=n,a.squad[s]-=n}},contractIsOver({state:a,dispatch:e},t){a.contract_is_taken.forEach(((a,e,t)=>{t[e]=0})),"win"==t?(a.Kojania.prosperity*=1+a.takenContract.prosperity/100,a.Kojania.reputation+=a.takenContract.reputation,e("log2","Контракт выполнен."),"common"==a.takenContract.dif&&e("checkQuest","found_contract"),"hard"==a.takenContract.dif&&e("checkQuest","found_hard_contract")):"fail"==t?(a.Kojania.prosperity*=1-1.5*a.takenContract.prosperity/100,a.Kojania.reputation-=2*a.takenContract.reputation,e("log2","Контракт провален.")):a.Kojania.prosperity*=1-a.takenContract.prosperity/2/100},log1({state:a},e){a.messageLog1=e},log2({state:a},e){a.messageLog2.push(e)},showWhatHiden({state:a}){console.log(a.contract_list)},showQuestMsg({dispatch:a},e){a("finishMissionMessage",{text:e[e.active].finishText,msg:e[e.active].niceQuestMsgs})},finishMissionMessage({state:a},{text:e,msg:t}){a.modalMissionParagraphs=e.split("|"),a.modalMission=!0,a.niceQuestMsgs=t},hire({commit:a,state:e},t){a("hire_reset_helper",1),e.gold>=e.Kojania.hirecost*t&&e.Kojania.availableWarriors>0?(a("hire",t),isNaN(e.lastMonthGoldHist.Cost.hire[e.day-1])&&(e.lastMonthGoldHist.Cost.hire[e.day-1]=0),e.lastMonthGoldHist.Cost.hire[e.day-1]-=e.Kojania.hirecost*t,a("summFinance","Cost.hire")):e.Kojania.availableWarriors>0?a("error","Нужно больше золота."):a("error","Рекруты закончились. Возможно завтра будут новые."),a("hire_reset_helper",1)},buyReservSpace({commit:a,state:e},t){e.costReservPlace=50+5*(e.reservCapacity-20),e.costReservPlacex10=275+10*(50+5*(e.reservCapacity-20)),1==t&&e.costReservPlace<e.gold?(a("buyReservSpace",t),e.gold-=e.costReservPlace):1==t&&a("error","Нужно больше золота."),10==t&&e.costReservPlacex10<e.gold?(a("buyReservSpace",t),e.gold-=e.costReservPlacex10):10==t&&a("error","Нужно больше золота.")}},getters:{payday:(a,e)=>{let t=0,o=0;for(let s in a.squad)t+=a.squad[s]*a.wpc[s];for(let s in a.squadReserved)o+=a.squadReserved[s]*a.wpc[s];return t+o},power:(a,e)=>{let t=0;for(let o in a.squad)t+=a.squad[o]*a.wp[o];return t},totalPeople:a=>{let e=0;for(let t in a.squad)e+=a.squad[t];return e},demonicPresence:(a,e)=>{for(const t of a.Kojania.demonicPresenceList)if(Math.min(9e3,a.Kojania.demonicPresence)<=t.num)return[t.text,t.className]},kojaniaReputation:(a,e)=>{for(const t of a.Kojania.reputationList)if(Math.min(1e4,a.Kojania.repSumm)<=t.num)return[t.text,t.className]},kojaniaProsperity:(a,e)=>{for(const t of a.Kojania.prosperityList)if(Math.min(5e3,a.Kojania.prosperity)<=t.num)return[t.text,t.className]},targetAvailableWarriors:(a,e)=>Math.floor(a.Kojania.availableWarriors*Math.min(.6*(1+Math.pow(a.Kojania.prosperity,.5)/100),1)+Math.pow(a.Kojania.reputation+10,.7)/2),totalReserved:(a,e)=>{let t=0;for(let o in a.squadReserved)t+=a.squadReserved[o];return t},reservTax:(a,e)=>{let t=0;for(let o in a.squadReserved)t+=a.squadReserved[o]*a.wpc[o]*(a.reservPaymentCoef/7);return Math.round(t)},reservExp:(a,e)=>{let t=0;for(let o in a.squadReserved)t+=a.squadReserved[o]*a.expbaseinc[o][0];return Math.round(t)},moralRenown:a=>Math.floor(Math.pow(a.squadState.reputation,.6)),moralDept:(a,e)=>{let t=0;return a.gold<0&&(t=Math.floor(a.gold/e.payday*20)),Math.max(-100,t)},moralSquadSize:(a,e)=>Math.floor(Math.pow(e.totalPeople,.6)/1.5),moralRich:(a,e)=>{let t;return t=a.gold>0?(a.gold-e.payday)/e.payday:0,t=Math.floor(5*t),Math.min(20,t)},morality:(a,e)=>Math.min(50+a.moralModifiers.Victory+a.moralModifiers.smallVictory+e.moralRenown+e.moralRich-a.moralModifiers.humanLost-a.moralModifiers.powerLost-a.moralModifiers.Defeat-e.moralSquadSize,100)}}}});f(Ut).use(zt).mount("#app");
